/*
 (c) 2017 Andrea Giammarchi @WebReflection, (ISC)  Copyright (c) 2017, Andrea Giammarchi, @WebReflection  (C) 2017 Andrea Giammarchi - @WebReflection - ISC License */
'use strict';(function(N){function A(b){if(g[b])return g[b].exports;var e=g[b]={i:b,l:!1,exports:{}};N[b].call(e.exports,e,e.exports,A);e.l=!0;return e.exports}var g={};A.m=N;A.c=g;A.d=function(b,e,f){A.o(b,e)||Object.defineProperty(b,e,{configurable:!1,enumerable:!0,get:f})};A.n=function(b){var e=b&&b.__esModule?function(){return b["default"]}:function(){return b};A.d(e,"a",e);return e};A.o=function(b,e){return Object.prototype.hasOwnProperty.call(b,e)};A.p="";return A(A.s=0)})([function(N,A){(function(g){function b(f){if(e[f])return e[f].exports;
var c=e[f]={i:f,l:!1,exports:{}};g[f].call(c.exports,c,c.exports,b);c.l=!0;return c.exports}var e={};b.m=g;b.c=e;b.d=function(f,c,a){b.o(f,c)||Object.defineProperty(f,c,{configurable:!1,enumerable:!0,get:a})};b.n=function(f){var c=f&&f.__esModule?function(){return f["default"]}:function(){return f};b.d(c,"a",c);return c};b.o=function(b,c){return Object.prototype.hasOwnProperty.call(b,c)};b.p="";return b(b.s=9)})([function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(13);b.wire=
function(c,a){return f.wire(c,a)};b.bind=function(c){return f.bind(c)}},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});b.profilePath="/profile/:uid";b.newProfilePath=function(b){return"/profile/"+b};b.aboutPath="/about";b.articlePath="/article:id";b.articleListPath="/";b.errorPath="/error"},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(22);g=function(){function c(){}c.parseIdToken=function(a){try{return{claims:{admin:JSON.parse(f.base64.decodeUnicode(a.split(".")[1]))[c.adminClaim]},
err:null}}catch(l){return{claims:c.defaultClaims,err:l.message}}};c.withClaims=function(a,c){return{signedIn:a.signedIn,uid:a.uid,name:a.name,email:a.email,claims:c}};c.signedOut=function(){return{signedIn:!1,uid:"",name:"",email:"",claims:c.defaultClaims}};c.fromFirebase=function(a){return{signedIn:!0,uid:a.uid,name:a.displayName||"",email:a.email||"",claims:c.defaultClaims}};c.adminClaim="admin";c.defaultClaims={admin:!1};return c}();b.userBuilder=g},function(g,b,e){Object.defineProperty(b,"__esModule",
{value:!0});var f=e(1);g=function(){function c(a){this.isPresenter=!0;this.path=f.errorPath;this.currentUser=a.currentUser;this.title=a.title;this.message=a.message}c.prototype.toJSON=function(){return JSON.stringify(this.toObject())};c.FromCode=function(a,b){switch(a){case 404:return new c({title:"Not Found",message:"Page Not Found",currentUser:b});default:return new c({title:"Internal Error",message:"Internal Error",currentUser:b})}};c.Init=function(a){return new c({title:a.title,currentUser:a.currentUser,
message:a.message})};c.prototype.toObject=function(){return{title:this.title,isPresenter:this.isPresenter,path:this.path,currentUser:this.currentUser,message:this.message}};return c}();b.ErrorPresenter=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(1),c=e(5);g=function(){function a(a){this.title="Profile";this.isPresenter=!0;this.path=f.profilePath;this.currentUser=a.currentUser;this.userProfile=a.userProfile}a.Init=function(c){return new a({currentUser:c.currentUser,
userProfile:c.userProfile})};a.Empty=function(b,f){return new a({currentUser:f,userProfile:c.userProfileBuilder.empty(b)})};a.prototype.toJSON=function(){return JSON.stringify(this.toObject())};a.prototype.toObject=function(){return{title:this.title,isPresenter:this.isPresenter,path:this.path,currentUser:this.currentUser,userProfile:this.userProfile}};return a}();b.ProfilePresenter=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(2);g=function(){function a(){}a.empty=function(a){return{uid:a,
name:"",email:"",admin:!1,claims:f.userBuilder.defaultClaims}};a.fromDB=function(a){var b=c(a.claims);return{uid:a.uid,name:a.name,email:a.email,admin:b[f.userBuilder.adminClaim],claims:b}};a.fromUser=function(a){var b=c(a.claims);return{uid:a.uid,name:a.name,email:a.email,admin:b[f.userBuilder.adminClaim],claims:b}};a.toUser=function(a,c){return{signedIn:c,uid:a.uid,name:a.name,email:a.email,claims:a.claims}};return a}();b.userProfileBuilder=g;var c=function(a){return a&&a.hasOwnProperty(f.userBuilder.adminClaim)?
a:f.userBuilder.defaultClaims}},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(1);g=function(){function c(a){this.title="About";this.isPresenter=!0;this.path=f.aboutPath;this.currentUser=a.currentUser}c.prototype.toJSON=function(){return JSON.stringify(this.toObject())};c.Init=function(a){return new c({currentUser:a.currentUser})};c.prototype.toObject=function(){return{title:this.title,isPresenter:this.isPresenter,path:this.path,currentUser:this.currentUser}};return c}();
b.AboutPresenter=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(1);g=function(){function c(a){this.title="Articles";this.isPresenter=!0;this.path=f.articleListPath;this.currentUser=a.currentUser;this.message=a.message}c.prototype.toJSON=function(){return JSON.stringify(this.toObject())};c.Init=function(a){return new c({currentUser:a.currentUser,message:a.message})};c.prototype.toObject=function(){return{title:this.title,isPresenter:this.isPresenter,path:this.path,currentUser:this.currentUser,
message:this.message}};return c}();b.ArticleListPresenter=g},function(g,b){g.exports=firebase},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(10),c=e(21),a=e(23),l=e(24);b=e(30);var w=e(31);g=e(32);e=e(33);f=f.getClientConfig();a=a.log(f.isOnline);a.info("init app start");var q=document.getElementById("app");if(q){var h=c.getPresenter();c=h.presenter;h=h.errMessage;if(null===c)a.error("getPresenter() failed; error="+h);else{l=new l.Domain({logger:a});var u=l.auth().currentUser().getFromCache();
h=u.currentUser;u=u.err;null===h?a.info("auth().currentUser().getFromCache() failed; reason="+u):c.currentUser=h;b=new w.App({domain:l,presenter:c,page:new b.Page({view:f.view,body:q}),logger:a});b.render();new g.ActionHandler({app:b,domain:l,logger:a});e.router(b);a.info("init app done")}}else a.error("could not find id: #app")},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(11),c=e(15),a=e(16),l=e(17),w=e(19),q=e(20);b.getServerConfig=function(){return h()};b.getClientConfig=
function(){return h()};var h=function(){var b={header:new l.HeaderView({logo:{name:"Viperfire",url:"/"}}),articleList:new c.ArticleListView,about:new a.AboutView({hyperLink:{name:"HyperHTML",url:"https://github.com/WebReflection/hyperHTML"},viperLink:{name:"ViperHTML",url:"https://github.com/WebReflection/viperhtml"},links:[{name:"HyperHTML",url:"https://github.com/WebReflection/hyperHTML"},{name:"ViperHTML",url:"https://github.com/WebReflection/viperhtml"}]}),footer:new w.FooterView({links:[{name:"Home",
url:"/"},{name:"About",url:"/about"}]})};return{isOnline:q.env.online,view:new f.View(b)}}},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(12),c=e(14),a=e(1);g=function(){function b(a){this.profile=new f.ProfileView;this.error=new c.ErrorView;this.header=a.header;this.footer=a.footer;this.articleList=a.articleList;this.about=a.about}b.prototype.renderArticleList=function(a,b){return this.render(a,b.currentUser,this.articleList.render(b))};b.prototype.renderProfile=function(a,
b){return this.render(a,b.currentUser,this.profile.render(b))};b.prototype.renderAbout=function(a,b){return this.render(a,b.currentUser,this.about.render())};b.prototype.renderError=function(a,b){return this.render(a,b.currentUser,this.error.render(b))};b.prototype.render=function(b,c,h){var f=[];c.signedIn&&(f[0]={name:"My Profile",url:a.newProfilePath(c.uid)});return e=["\n            <header>","</header>\n            <main>","</main>\n            <footer>","</footer>\n        "],e.raw=["\n            <header>",
"</header>\n            <main>","</main>\n            <footer>","</footer>\n        "],b(e,[this.header.render(c)],[h],[this.footer.render({links:f})]);var e};return b}();b.View=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(0);g=function(){function b(){this.html=f.wire(this)}b.prototype.render=function(a){return b=["\n            <h2>","</h2>\n            <p>Admin? ","</p>\n        "],b.raw=["\n            <h2>","</h2>\n            <p>Admin? ","</p>\n        "],this.html(b,
a.userProfile.name,a.userProfile.admin);var b};return b}();b.ProfileView=g},function(g,b){b=function(b,f){function c(m){return 2>arguments.length?null==m?H("html"):"string"==typeof m?e(null,m):"raw"in m?H("html")(m):"nodeType"in m?a(m):fa(m,"html"):("raw"in m?H("html"):e).apply(null,arguments)}function a(m){return h.bind(m)}function e(m,a){return 1>arguments.length?H("html"):null==m?H(a||"html"):fa(m,a||"html")}function g(){}function q(m,a){return this.node=m,this.childNodes=a,f.aura(this,a)}function h(m){var a=
V.get(this);return a&&a.template===O(m)?W.apply(a.updates,arguments):Ba.apply(this,arguments),this}function u(m,a,b){var c,d,h,x=m.ownerElement,n="data"===b,k=!n&&/^on/.test(b),p=n||E(x,b)&&!Ca.test(b),f=k?b.slice(2):"",K=p||k,e=p&&(n||b in x);return(k||e)&&(a.push(x,b),k&&(f===L||f===X?ha.add(x):b.toLowerCase()in x&&(f=f.toLowerCase()))),p&&(e||(h=P.get(x),h||(h={_:Object.create(null),$:function(){P.delete(x);for(var a in this._)this._[a].$()}},P.set(x,h)),h._[b]={_:null,$:function(){e=!0;d(this._)}}),
d=function(a){e?c!==a&&(c=a,x[b]!==a&&(null==a?(x[b]=null,x.removeAttribute(b)):x[b]=a)):(m.value=a,h._[b]._=a,b in x&&h.$())}),k?function(a){c!==a&&(c&&x.removeEventListener(f,c,!1),c=a,a&&x.addEventListener(f,a,!1))}:p?d:function(a){c!==a&&(c=a,m.value!==a&&(null==a?K||(K=!0,x.removeAttributeNode(m)):(m.value=a,K&&(K=!1,x.setAttributeNode(m)))))}}function r(a){var b;return function(m){m!==b&&(b=m,a.textContent=m)}}function k(a,b,c){var m;return function B(d){switch(typeof d){case "string":case "number":case "boolean":var h=
b.length;1===h&&b[0].nodeType===Y?m!==d&&(m=d,b[0].textContent=d):(m=d,h?c.splice(0,h,a.ownerDocument.createTextNode(d)):b[0]=a.parentNode.insertBefore(a.ownerDocument.createTextNode(d),a));break;case "function":B(d(a.parentNode,b,0));break;case "object":case "undefined":if(null==d){m=d;B("");break}d instanceof g&&(d=d.render());default:if(m=d,ia(d))if(h=d.length,0===h)c.splice(0);else switch(typeof d[0]){case "string":case "number":case "boolean":B({html:d});break;case "function":for(var x=a.parentNode,
k=0;k<h;k++)d[k]=d[k](x,b,k);B(d.concat.apply([],d));break;case "object":ia(d[0])&&(d=d.concat.apply([],d));h=d[0];if(null!=h&&"then"in h){Promise.all(d).then(B);break}k=0;for(h=d.length;k<h;k++)d[k]instanceof g&&(d[k]=d[k].render());default:C(c,d)}else"ELEMENT_NODE"in d?C(c,d.nodeType===ja?F.call(d.childNodes):[d]):null!=d&&"then"in d?d.then(B):"placeholder"in d?(B(d.placeholder),"text"in d?Promise.resolve(d.text).then(String).then(B):"any"in d?Promise.resolve(d.any).then(B):"html"in d?Promise.resolve(d.html).then(n).then(B):
Promise.resolve(v(d,B)).then(B)):"text"in d?B(String(d.text)):"any"in d?B(d.any):"html"in d?(d=[].concat(d.html).join(""),c.splice(0),d=(T in a?ka:la)(a,d.replace(ma,na)),b.push.apply(b,d.childNodes),a.parentNode.insertBefore(d,a)):B("length"in d?F.call(d):v(d,B))}}}function d(a,b,c){for(var m,h=a.childNodes,k=h.length,x=0;x<k;x++)switch(m=h[x],m.nodeType){case I:for(var n,p=void 0,f=void 0,e=void 0,u=m,K=b,r=c,t=Object.create(null),g=u.attributes,l=0,q=g.length;l<q;l++)n=g[l],n.value===G&&(e=n.name,
e in t?(u.removeAttributeNode(n),t[e].value="",u.setAttributeNode(t[e]),q--,l--):(f=r.shift().replace(/^(?:|[\S\s]*?\s)(\S+?)=['"]?$/,"$1"),p=u.attributes,t[e]=p[f]||p[f.toLowerCase()],K.push(y("attr",t[e],f))));d(m,b,c);break;case oa:m.textContent===G&&(c.shift(),b.push(y("any",m)));break;case Y:Da.test(a.nodeName)&&pa.call(m.textContent)===U&&(c.shift(),b.push(y("text",a)))}}function p(a){return Ea[a]}function n(a){return{html:a}}function la(a,d){var b,m=a.ownerDocument;a=m.createElement(/<([a-z][a-z0-9]*(?:-[a-z0-9]+)+)[\s\S]*?>[\s\S]*?<\/\1>/i.test(d)?
"div":"template");var c="content"in a,h=!1;(c||(b=m.createDocumentFragment(),h=/^[^\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(d)),h)?(m=RegExp.$1,a.innerHTML="<table>"+d+"</table>",Q(b,F.call(a.querySelectorAll(m)))):(a.innerHTML=d,c?b=a.content:Q(b,F.call(a.childNodes)));return b}function ka(a,b){var d=a.ownerDocument;a=d.createDocumentFragment();R||Z?(d=d.createElement("div"),d.innerHTML='<svg xmlns="'+aa+'">'+b+"</svg>",Q(a,F.call(d.firstChild.childNodes))):(d=d.createElementNS(aa,
"svg"),d.innerHTML=b,Q(a,F.call(d.childNodes)));return a}function t(a,d){for(var b,m,c=d===L,h=0,k=a.length;h<k;h++)m=a[h],m.nodeType===I&&(b=z(m,c,d,b))}function z(a,d,b,c){if(ha.has(a))a.dispatchEvent(c||(c=new qa(b)));else if(d&&P.has(a))P.get(a).$();else{a=M(a);for(var m=0,h=a.length;m<h;m++)c=z(a[m],d,b,c)}return c}function E(a,d){var b=!(T in a);if(b&&/-/.test(a.nodeName)){var m=c.document;(m=(m=m.customElements||m.defaultView.customElements)&&m.get(a.nodeName.toLowerCase()))&&(a=m.prototype)}return b&&
d in a}function v(a,d){for(var b,c=0,m=ba.length;c<m;c++)if(b=ba[c],a.hasOwnProperty(b))return ca[b](a[b],d)}function D(a,d){var b="_"+a+"$";return{get:function(){return this[b]||(this[a]=d.call(this,a))},set:function(a){Fa(this,b,{configurable:!0,value:a})}}}function C(a,d){var b=0,m=a.length;if(d.length!==m)f(a,d,c.MAX_LIST_SIZE);else for(;b<m--;b++)if(a[m]!==d[m]||a[b]!==d[b])return void f(a,d,c.MAX_LIST_SIZE)}function ra(a){for(var d=0,b=a.length;d<b;d++)a[d++].removeAttribute(a[d])}function A(a,
d,b,c){switch(a.type){case "any":var m=k(d,c,new q(d,c));break;case "attr":m=u(d,b,a.name);break;case "text":m=r(d)}return m}function y(a,d,b){var c=[];switch(d.nodeType){case I:case ja:var m=d;break;case oa:m=d.parentNode;c.unshift("childNodes",c.indexOf.call(m.childNodes,d));break;default:m=d.ownerElement,c.unshift("attributes",d.name)}for(d=m;m=m.parentNode;d=m)c.unshift("children",c.indexOf.call(M(m),d));return{type:a,path:c,name:b}}function N(a){var d="_"+a.join(U);return ta[d]||(ta[d]=a)}function ua(a,
d){var b=d.previousSibling;b&&b.nodeType===Y&&(a.removeChild(b),ua(a,d))}function W(){for(var a=1,d=arguments.length;a<d;a++)this[a-1](arguments[a])}function Ba(a){a=O(a);var b;if(!(b=va.get(a))){b=a;var c=[];var h=b.join(U);h=(T in this?ka:la)(this,h.replace(ma,na));var m={fragment:h,paths:c};b=(d(h,c,b.slice()),va.set(b,m),m)}c=b;if(da){b=wa(c.fragment);c=c.paths;m=[];for(var k=[],n=0,p=c.length;n<p;n++)h=c[n],m[n]=A(h,ea(b,h.path),k,[]);c=(ra(k),m);V.set(this,{template:a,updates:c});W.apply(c,
arguments);this.textContent="";this.appendChild(b)}else{b=c.fragment;c=c.paths;m=[];k=[];n=0;for(p=c.length;n<p;n++){h=[];var f=c[n];var e=n,u=f,t=this,r=b,g=h,l=t,q=t.ownerDocument;f=f.path;for(var E=ea(r,f),z=0,w=f.length;z<w;z++)switch(f[z++]){case "attributes":l=E.name;t.hasAttribute(l)||t.setAttribute(l,"");l=t.attributes[l];break;case "childNodes":var v=M(t),D=M(E.parentNode),C=(l=Ga(E))?f.indexOf.call(D,l)+1:-1,y=(l=xa(E))?f.indexOf.call(D,l):-1;switch(l=q.createComment(G),!0){case 0>y:y=v.length;
break;case 0>C:C=0;default:y=-(D.length-y)}g.push.apply(g,F.call(v,C,y));g.length?(v=t,y=l,(D=xa(g[g.length-1]))?v.insertBefore(y,D):v.appendChild(y)):(D=t,C=l,(v=F.call(v,y)[0])?D.insertBefore(C,v):D.appendChild(C));0===g.length&&ua(t,l);break;default:t=l=M(t)[f[z]]||t.appendChild(t.ownerDocument.createElement(ea(r,f.slice(0,z+1)).nodeName))}m[e]=A(u,l,k,h)}c=(ra(k),m);V.set(this,{template:a,updates:c});W.apply(c,arguments)}}function H(d){function b(b){f=b.createDocumentFragment();n="svg"===d?b.createElementNS(aa,
"svg"):f;p=a(n)}function h(){if(e){e=!1;"svg"===d&&Q(f,F.call(n.childNodes));for(var a,b=[],c=f.childNodes,h=0,m=c.length;h<m;h++)a=c[h],a.nodeType!==I&&0===pa.call(a.textContent).length||b.push(a);k=1===b.length?b[0]:b}return k}var m,k,n,f,p,e,t;return"adopt"===d?function(a){var k=arguments;return a=O(a),t!==a&&(e=!0,t=a,m=function(a,m,t){return e&&(t<m.length?(n=m[t],f={ownerDocument:n.ownerDocument,childNodes:[n],children:[n]},p=c.adopt(f)):(T in a&&(d="svg"),b(a.ownerDocument))),p.apply(null,
k),h()}),m}:function(a){return a=O(a),t!==a&&(e=!0,t=a,b(c.document)),p.apply(null,arguments),h()}}function fa(a,d){var b=ya.get(a),c=d.indexOf(":"),h=d;return-1<c&&(h=d.slice(c+1),d=d.slice(0,c)||"html"),b||(b={},ya.set(a,b)),b[h]||(b[h]=H(d))}c.document=b;c.hyper=c;c.adopt=function(a){return function(){return da=!1,h.apply(a,arguments),da=!0,a}};c.bind=a;c.define=function(a,d){a in ca||ba.push(a);ca[a]=d};c.escape=function(a){return a.replace(/[&<>'"]/g,p)};c.wire=e;c.Component=g;Object.defineProperties(g.prototype,
{handleEvent:{value:function(a){var d=a.currentTarget;this["getAttribute"in d&&d.getAttribute("data-call")||"on"+a.type](a)}},html:D("html",H),svg:D("svg",H),state:D("state",function(){return this.defaultState}),defaultState:{get:function(){return{}}},setState:{value:function(a){var d=this.state;a="function"==typeof a?a.call(this,d):a;for(var b in a)d[b]=a[b];this.render()}}});var I=1,Y=3,oa=8,ja=11,T="ownerSVGElement",aa="http://www.w3.org/2000/svg",Ca=/^style$/i,Da=/^style|textarea$/i,G="_hyper: "+
(Math.random()*new Date|0)+";",U="\x3c!--"+G+"--\x3e";q.prototype.splice=function(a){var d=this.node;for(var b=this.childNodes,c=b[a+(arguments[1]||0)]||d,h=b.splice.apply(b,arguments),k=d.parentNode,n=0,m=h.length;n<m;n++)d=h[n],0>b.indexOf(d)&&k.removeChild(d);if(n=2,m=arguments.length,n<m){if(1==m-n)d=arguments[n];else for(d=k.ownerDocument.createDocumentFragment();n<m;)d.appendChild(arguments[n++]);k.insertBefore(d,c)}return h};var J=b.createDocumentFragment(),Ha="object"==typeof navigator&&/Firefox\/(\d+)/.test(navigator.userAgent)&&
55>parseFloat(RegExp.$1),R=function(){var a=b.createElement("p");return a.innerHTML='<i data-i="" class=""></i>',/class/i.test(a.firstChild.attributes[0].name)}(),Z=!("children"in J),O=function(a){return(O=a.propertyIsEnumerable("raw")||Ha?N:function(a){return a})(a)},F=[].slice,Ea={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},L="connected",X="dis"+L;try{new Event(L);var qa=Event}catch(m){qa=function(a){var d=c.document.createEvent("Event");return d.initEvent(a,!1,!1),d}}try{(new MutationObserver(function(a){for(var d,
b=0,c=a.length;b<c;b++)d=a[b],t(d.removedNodes,X),t(d.addedNodes,L)})).observe(b,{subtree:!0,childList:!0})}catch(m){b.addEventListener("DOMNodeInserted",function(a){t([a.target],L)},!1),b.addEventListener("DOMNodeRemoved",function(a){t([a.target],X)},!1)}var S=typeof WeakMap==typeof S?function(){return{delete:function(a){delete a[G]},get:function(a){return a[G]},has:function(a){return G in a},set:function(a,d){Object.defineProperty(a,G,{configurable:!0,value:d})}}}:WeakMap,za=typeof WeakSet==typeof za?
function(){var a=new S;return{add:function(d){a.set(d,!0)},has:function(d){return!0===a.get(d)}}}:WeakSet,Aa=typeof Map==typeof Aa?function(){var a=[],d=[];return{get:function(b){return d[a.indexOf(b)]},set:function(b,c){d[a.push(b)-1]=c}}}:Map,ia=Array.isArray||function(){var a={}.toString,d=a.call([]);return function(b){return a.call(b)===d}}(),pa="_hyper: ".trim||function(){return this.replace(/^\s+|\s+$/g,"")},Fa=Object.defineProperty,ca={},ba=[],ta={},Q="append"in J?function(a,d){a.append.apply(a,
d)}:function(a,d){for(var b=0,c=d.length;b<c;b++)a.appendChild(d[b])},M=Z||R?function(a){for(var d=[],b=a.childNodes,c=0,h=0,n=b.length;h<n;h++)a=b[h],a.nodeType===I&&(d[c++]=a);return d}:function(a){return a.children},ea=R||Z?function(a,d){for(var b,c=0,h=d.length;c<h;c++)switch(b=d[c++]){case "children":a=M(a)[d[c]];break;default:a=a[b][d[c]]}return a}:function(a,d){for(var b=0,c=d.length;b<c;b++)a=a[d[b++]][d[b]];return a},ma=/(<[a-z]+[a-z0-9:_-]*)((?:[^\S]+[^ \f\n\r\t\/>"'=]+(?:=(?:'.*?'|".*?"|<.+?>|\S+))?)+)([^\S]*\/?>)/gi,
Ia=new RegExp("([^\\S]+[^ \\f\\n\\r\\t\\/>\"'=]+=)(['\"]?)"+U+"\\2","gi"),na=function(a,d,b,c){return d+b.replace(Ia,Ja)+c},Ja=function(a,d,b){return d+(b||'"')+G+(b||'"')},ha=new za,V=new S,ya=new S,va=new Aa,P=new S,da=!0,wa=function(){return J.appendChild(J.ownerDocument.createTextNode("g")),J.appendChild(J.ownerDocument.createTextNode("")),1===J.cloneNode(!0).childNodes.length?function(a){var d=a.cloneNode();a=a.childNodes||[];for(var b=0,c=a.length;b<c;b++)d.appendChild(wa(a[b]));return d}:function(a){return a.cloneNode(!0)}}(),
xa=R?function(a){for(;a=a.nextSibling;)if(a.nodeType===I)return a}:function(a){return a.nextElementSibling},Ga=R?function(a){for(;a=a.previousSibling;)if(a.nodeType===I)return a}:function(a){return a.previousElementSibling};return c.MAX_LIST_SIZE=1E3,c}(document,function(){function b(b,h,e){var r=b.length,k=h.length;e=(e||1/0)<Math.sqrt((r||1)*(k||1));if(1>r||e)b=void((k||e)&&b.splice.apply(b,[0,r].concat(h)));else if(1>k)b=void b.splice(0);else{var d=b.length+1,p=h.length+1,n=0,l=0,u=0,t=0;r=new w(d*
p);for(r[0]=0;++n<p;)r[n]=n;for(;++l<d;){var q=n=0;var E=t;t=l*p;for(r[t+n]=l;++n<p;){k=r[E+n]+1;e=r[t+q]+1;var v=r[E+q]+(b[u]==h[q]?0:1);r[t+n]=k<e?k<v?k:v:e<v?e:v;++q}u=l}k=[];d=h.length+1;p=b.length+1-1;for(n=d-1;n&&p;)l=p*d+n,q=l-d,e=r[l],v=r[q],l=r[l-1],q=r[q-1],q<=l&&q<=v&&q<=e?(n--,p--,q<e&&f(k,g,n,p,1,[h[n]])):l<=v&&l<=e?(n--,f(k,a,n,p,0,[h[n]])):(p--,f(k,c,n,p,1,[]));for(;n--;)f(k,a,n,p,0,[h[n]]);for(;p--;)f(k,c,n,p,1,[]);v=0;d=1;if(p=k.length){for(e=r=k[0];d<p;)h=k[d++],r.type===h.type&&
1>=h.x-r.x&&1>=h.y-r.y?(e.count+=h.count,e.items=e.items.concat(h.items)):(b.splice.apply(b,[e.y+v,e.count].concat(e.items)),v+=e.type===a?e.items.length:e.type===c?-e.count:0,e=h),r=h;b.splice.apply(b,[e.y+v,e.count].concat(e.items))}b=void 0}return b}function f(a,b,c,e,k,d){a.unshift({type:b,x:c,y:e,count:k,items:d})}var c="del",a="ins",g="sub",w=/^u/.test(typeof Int32Array)?Array:Int32Array;return b.aura=function(a,b){var c=b.splice;return b.splice=function k(){b.splice=c;var d=a.splice.apply(a,
arguments);return b.splice=k,d},b},b}());try{g.exports=b}catch(e){}},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(0);g=function(){function b(){this.html=f.wire(this)}b.prototype.render=function(a){return b=['\n            <div class="page-error">\n                <p>',"</p>\n            </div>\n        "],b.raw=['\n            <div class="page-error">\n                <p>',"</p>\n            </div>\n        "],this.html(b,a.message);var b};return b}();b.ErrorView=g},function(g,
b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(0);g=function(){function b(){this.html=f.wire(this)}b.prototype.render=function(a){return b=['\n            <a href="/article/kalle">Kalle</a></br>\n            <a href="/profile/yuaTMIc27MMFAV2z19K1gySGw3k1">My profile</a>\n            <p>',"</p>\n        "],b.raw=['\n            <a href="/article/kalle">Kalle</a></br>\n            <a href="/profile/yuaTMIc27MMFAV2z19K1gySGw3k1">My profile</a>\n            <p>',"</p>\n        "],this.html(b,
a.message);var b};return b}();b.ArticleListView=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(0);g=function(){function b(a){this.hyperLink=a.hyperLink;this.viperLink=a.viperLink;this.links=a.links;this.html=f.wire(this)}b.prototype.render=function(){return a='\n            <h1>About Viperfire</h1>\n            <p>A starter application hosted on Firebase and using \n                <a href=";">;</a> \n                on the client and <a href=";">;</a> on the server\n            </p>\n            <p>Technologies used:</p>\n            <ul>\n                ;\n            </ul>'.split(";"),
a.raw='\n            <h1>About Viperfire</h1>\n            <p>A starter application hosted on Firebase and using \n                <a href=";">;</a> \n                on the client and <a href=";">;</a> on the server\n            </p>\n            <p>Technologies used:</p>\n            <ul>\n                ;\n            </ul>'.split(";"),this.html(a,this.hyperLink.url,this.hyperLink.name,this.viperLink.url,this.viperLink.name,this.links.map(function(a,b){return c=['\n                    <li><a href="',
'">',"</a></li>"],c.raw=['\n                    <li><a href="','">',"</a></li>"],f.wire(a)(c,a.url,a.name);var c}));var a};return b}();b.AboutView=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(18),c=e(0);g=function(){function a(a){this.logo=a.logo;this.html=c.wire(this)}a.prototype.render=function(a){var b=this.logo;if(a.signedIn){var c="header-account-link "+f.css.hide;a="header-account-link"}else c="header-account-link",a="header-account-link "+f.css.hide;return h=
['\n            <a href="','" class="header-logo">','</a>\n            <div class="header-account">\n                <div class="','">\n                    <a href="#sign-in" data-action="signInWithGoogle">Sign In with Google</a>\n                </div>\n                <div class="','">\n                    <a href="#sign-out" data-action="signOut">Sign Out</a>\n                </div>\n            </div>'],h.raw=['\n            <a href="','" class="header-logo">','</a>\n            <div class="header-account">\n                <div class="',
'">\n                    <a href="#sign-in" data-action="signInWithGoogle">Sign In with Google</a>\n                </div>\n                <div class="','">\n                    <a href="#sign-out" data-action="signOut">Sign Out</a>\n                </div>\n            </div>'],this.html(h,b.url,b.name,c,a);var h};return a}();b.HeaderView=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){}b.errHighlight="error-highlight";b.highlight="highlight";b.error=
"error";b.hide="hide";b.show="";b.empty="";return b}();b.css=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(0);g=function(){function b(a){this.html=f.wire(this);this.links=a.links}b.prototype.render=function(a){return b=['\n            <ul class="footer-list">\n                ',"\n                \n                ","\n            </ul>"],b.raw=['\n            <ul class="footer-list">\n                ',"\n                \n                ","\n            </ul>"],this.html(b,
this.links.map(function(a,b){return c=['\n                    <li class="footer-list-item"><a href="','">',"</a></li>"],c.raw=['\n                    <li class="footer-list-item"><a href="','">',"</a></li>"],f.wire(a)(c,a.url,a.name);var c}),a.links.map(function(a,b){return c=['\n                    <li class="footer-list-item"><a href="','">',"</a></li>"],c.raw=['\n                    <li class="footer-list-item"><a href="','">',"</a></li>"],f.wire(a)(c,a.url,a.name);var c}));var b};return b}();
b.FooterView=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){}b.online=!0;return b}();b.env=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(1),c=e(4),a=e(6),l=e(7),w=e(3);b.getPresenter=function(){try{var a=JSON.parse(window.__INITIAL_STATE__);return q(a)}catch(u){return{presenter:null,errMessage:u.message}}};var q=function(b){try{switch(b.path){case f.articleListPath:return{presenter:l.ArticleListPresenter.Init(b),errMessage:""};
case f.profilePath:return{presenter:c.ProfilePresenter.Init(b),errMessage:""};case f.aboutPath:return{presenter:a.AboutPresenter.Init(b),errMessage:""};case f.errorPath:return{presenter:w.ErrorPresenter.Init(b),errMessage:""};default:return{presenter:null,errMessage:b.path+" not found"}}}catch(u){return{presenter:null,errMessage:u.message}}}},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){}b.decodeUnicode=function(b){return decodeURIComponent(atob(b).split("").map(function(a){return"%"+
("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""))};return b}();b.base64=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});g=e(2);window.__VIPER__=window.__VIPER__||{user:g.userBuilder.signedOut()};var f=function(){function a(){}a.info=function(a){};a.error=function(a){};a.setUser=function(a){};return a}(),c=function(){function a(){}a.info=function(a){console.info(a)};a.error=function(a){console.error(a)};a.setUser=function(a){window.__VIPER__.user=a};return a}();b.log=function(a){return a?
f:c}},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(8),c=e(25),a=e(28),l=e(29),w=e(3),q=e(6);g=function(){function b(b){this.authDomain=new l.AuthDomain(f.app());this.profileDomain=new c.ProfileDomain({firestore:f.firestore(),logger:b.logger});this.articleDomain=new a.ArticleDomain({firestore:f.firestore()})}b.prototype.auth=function(){return this.authDomain};b.prototype.article=function(){return this.articleDomain};b.prototype.profile=function(){return this.profileDomain};
b.prototype.about=function(a){return new q.AboutPresenter({currentUser:a})};b.prototype.error=function(a,b){return w.ErrorPresenter.FromCode(a,b)};return b}();b.Domain=g},function(g,b,e){var f=this&&this.__awaiter||function(a,b,d,c){return new (d||(d=Promise))(function(h,k){function n(a){try{p(c.next(a))}catch(v){k(v)}}function e(a){try{p(c["throw"](a))}catch(v){k(v)}}function p(a){a.done?h(a.value):(new d(function(b){b(a.value)})).then(n,e)}p((c=c.apply(a,b||[])).next())})},c=this&&this.__generator||
function(a,b){function d(a){return function(b){return c([a,b])}}function c(d){if(k)throw new TypeError("Generator is already executing.");for(;h;)try{if(k=1,e&&(f=e[d[0]&2?"return":d[0]?"throw":"next"])&&!(f=f.call(e,d[1])).done)return f;if(e=0,f)d=[0,f.value];switch(d[0]){case 0:case 1:f=d;break;case 4:return h.label++,{value:d[1],done:!1};case 5:h.label++;e=d[1];d=[0];continue;case 7:d=h.ops.pop();h.trys.pop();continue;default:if(!(f=h.trys,f=0<f.length&&f[f.length-1])&&(6===d[0]||2===d[0])){h=
0;continue}if(3===d[0]&&(!f||d[1]>f[0]&&d[1]<f[3]))h.label=d[1];else if(6===d[0]&&h.label<f[1])h.label=f[1],f=d;else if(f&&h.label<f[2])h.label=f[2],h.ops.push(d);else{f[2]&&h.ops.pop();h.trys.pop();continue}}d=b.call(a,h)}catch(v){d=[6,v],e=0}finally{k=f=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}var h={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},k,e,f,g;return g={next:d(0),"throw":d(1),"return":d(2)},"function"===typeof Symbol&&(g[Symbol.iterator]=
function(){return this}),g};Object.defineProperty(b,"__esModule",{value:!0});var a=e(26),l=e(4),w=e(27),q=e(5);g=function(){function b(a){this.db=a.firestore;this.logger=a.logger;this.cache=new h;this.subscriptions=new u}b.prototype.get=function(b){return f(this,void 0,void 0,function(){var d,h,e,f,k,g,r,u,v,D,C;return c(this,function(c){switch(c.label){case 0:d=this.cache[b.uid];h=a.profilePath(b.uid);if(d)return this.logger.info("cache hit "+h),e=new l.ProfilePresenter({currentUser:b.currentUser,
userProfile:d}),[2,{code:w.statusCode.OK,presenter:e,err:null}];this.logger.info("cache miss "+h);c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.db.doc(h).get()];case 2:f=c.sent();if(!f.exists)return k=w.domainNotFound(h),g=k.code,r=k.err,u=l.ProfilePresenter.Empty(b.uid,b.currentUser),[2,{code:g,presenter:u,err:r}];v=q.userProfileBuilder.fromDB(f.data());e=new l.ProfilePresenter({currentUser:b.currentUser,userProfile:v});return[2,{code:w.statusCode.OK,presenter:e,err:null}];case 3:return D=
c.sent(),C=w.domainInternalError(h,D.message),g=C.code,r=C.err,e=l.ProfilePresenter.Empty(b.uid,b.currentUser),[2,{code:g,presenter:e,err:r}];case 4:return[2]}})})};b.prototype.subscribe=function(b){var d=this,c=a.profilePath(b);this.logger.info("subscribe to "+c);this.subscriptions[b]=this.db.doc(c).onSnapshot(function(a){a.exists?(d.logger.info("add "+c+" to cache"),d.cache[b]=q.userProfileBuilder.fromDB(a.data()),d.logger.info(c+" updated on "+(a.metadata.hasPendingWrites?"Client":"Server"))):
d.unsubscribe(b)})};b.prototype.unsubscribe=function(b){if(""!==b){var d=a.profilePath(b);this.logger.info("unsubscribe to "+d);delete this.cache[b];if(d=this.subscriptions[b])this.logger.info("calling unsubscribe"),d(),this.logger.info("called unsubscribe"),delete this.subscriptions[b]}};return b}();b.ProfileDomain=g;var h=function(){return function(){}}(),u=function(){return function(){}}()},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});b.profileCollection="profiles";b.profilePath=
function(e){return b.profileCollection+"/"+e}},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f;(function(b){b[b.OK=200]="OK";b[b.InternalError=500]="InternalError";b[b.NotFound=404]="NotFound"})(f=b.statusCode||(b.statusCode={}));b.domainNotFound=function(b){return{code:f.NotFound,err:b+" Not Found"}};b.domainInternalError=function(b,a){return{code:f.InternalError,err:b+" Internal Error="+a}}},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(7);g=function(){function b(a){this.db=
a.firestore}b.prototype.all=function(a){return new f.ArticleListPresenter({currentUser:a.currentUser,message:"Hello World"})};return b}();b.ArticleDomain=g},function(g,b,e){var f=this&&this.__awaiter||function(a,b,c,e){return new (c||(c=Promise))(function(d,h){function f(a){try{p(e.next(a))}catch(z){h(z)}}function k(a){try{p(e["throw"](a))}catch(z){h(z)}}function p(a){a.done?d(a.value):(new c(function(b){b(a.value)})).then(f,k)}p((e=e.apply(a,b||[])).next())})},c=this&&this.__generator||function(a,
b){function c(a){return function(b){return h([a,b])}}function h(c){if(e)throw new TypeError("Generator is already executing.");for(;d;)try{if(e=1,f&&(g=f[c[0]&2?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;if(f=0,g)c=[0,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return d.label++,{value:c[1],done:!1};case 5:d.label++;f=c[1];c=[0];continue;case 7:c=d.ops.pop();d.trys.pop();continue;default:if(!(g=d.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){d=0;continue}if(3===
c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))d.label=c[1];else if(6===c[0]&&d.label<g[1])d.label=g[1],g=c;else if(g&&d.label<g[2])d.label=g[2],d.ops.push(c);else{g[2]&&d.ops.pop();d.trys.pop();continue}}c=b.call(a,d)}catch(z){c=[6,z],f=0}finally{e=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var d={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},e,f,g,l;return l={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),
l};Object.defineProperty(b,"__esModule",{value:!0});var a=e(8),l=e(2);g=function(){function b(a){this.firebase=a;this.cache=new w(a.options)}b.prototype.getClaims=function(a){return f(this,void 0,void 0,function(){var b,h;return c(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,a.getIdToken()];case 1:return b=d.sent(),[2,l.userBuilder.parseIdToken(b)];case 2:return h=d.sent(),[2,{claims:l.userBuilder.defaultClaims,err:h.message}];case 3:return[2]}})})};b.prototype.onAuthStatChanged=
function(a){var b=this;this.firebase.auth().onAuthStateChanged(function(h){return f(b,void 0,void 0,function(){return c(this,function(b){a(h);return[2]})})})};b.prototype.currentUser=function(){return this.cache};b.prototype.GooglePopup=function(){var b=new a.auth.GoogleAuthProvider;return new q({firebase:this.firebase,provider:b})};return b}();b.AuthDomain=g;var w=function(){function a(a){this.key="firebase:authUser:"+a.apiKey+":[DEFAULT]"}a.prototype.getFromCache=function(){if(!window.localStorage)return{currentUser:null,
err:"no local storage in this browser"};var a=localStorage.getItem(this.key);if(!a)return{currentUser:null,err:"no user exists in local storage; apiKey="+this.key};try{var b=JSON.parse(a);return{currentUser:l.userBuilder.fromFirebase(b),err:""}}catch(k){return{currentUser:null,err:"local storage JSON.parse(text); test="+a+"; error="+k.message}}};return a}(),q=function(){function a(a){this.firebase=a.firebase;this.provider=a.provider}a.prototype.signInWithPopup=function(){return f(this,void 0,void 0,
function(){var a,b,h,d;return c(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,this.firebase.auth().signInWithPopup(this.provider)];case 1:return a=c.sent(),b=a.user,[2,{currentUser:l.userBuilder.fromFirebase(b),err:""}];case 2:return d=h=c.sent(),[2,{currentUser:null,err:d.message}];case 3:return[2]}})})};a.prototype.signOut=function(){return f(this,void 0,void 0,function(){return c(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.firebase.auth().signOut()];
case 1:return a.sent(),[2,!0];case 2:return a.sent(),[2,!1];case 3:return[2]}})})};return a}()},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(0);(function(){return function(){}})();g=function(){function b(a){this.renderBody=f.bind(a.body);this.view=a.view}b.prototype.articleList=function(a){this.view.renderArticleList(this.renderBody,a);document.title=a.title};b.prototype.profile=function(a){this.view.renderProfile(this.renderBody,a);document.title=a.title};b.prototype.about=
function(a){this.view.renderAbout(this.renderBody,a);document.title=a.title};b.prototype.error=function(a){this.view.renderError(this.renderBody,a);document.title=a.title};return b}();b.Page=g},function(g,b,e){var f=this&&this.__awaiter||function(a,b,c,e){return new (c||(c=Promise))(function(h,d){function f(a){try{g(e.next(a))}catch(t){d(t)}}function k(a){try{g(e["throw"](a))}catch(t){d(t)}}function g(a){a.done?h(a.value):(new c(function(b){b(a.value)})).then(f,k)}g((e=e.apply(a,b||[])).next())})},
c=this&&this.__generator||function(a,b){function c(a){return function(b){return e([a,b])}}function e(c){if(d)throw new TypeError("Generator is already executing.");for(;h;)try{if(d=1,f&&(g=f[c[0]&2?"return":c[0]?"throw":"next"])&&!(g=g.call(f,c[1])).done)return g;if(f=0,g)c=[0,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return h.label++,{value:c[1],done:!1};case 5:h.label++;f=c[1];c=[0];continue;case 7:c=h.ops.pop();h.trys.pop();continue;default:if(!(g=h.trys,g=0<g.length&&g[g.length-1])&&
(6===c[0]||2===c[0])){h=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))h.label=c[1];else if(6===c[0]&&h.label<g[1])h.label=g[1],g=c;else if(g&&h.label<g[2])h.label=g[2],h.ops.push(c);else{g[2]&&h.ops.pop();h.trys.pop();continue}}c=b.call(a,h)}catch(t){c=[6,t],f=0}finally{d=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var h={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},d,f,g,l;return l={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&
(l[Symbol.iterator]=function(){return this}),l};Object.defineProperty(b,"__esModule",{value:!0});var a=e(2),l=e(1),w=e(3);(function(){return function(){}})();g=function(){function b(a){this.pageCounter=0;this.page=a.page;this.presenter=a.presenter;this.logger=a.logger;this.domain=a.domain}b.prototype.rootVisit=function(){this.root("rootVisit")};b.prototype.rootBack=function(){this.root("rootBack")};b.prototype.root=function(a){var b=this;a=this.updatePageCounter(a);var c=this.domain.article().all({currentUser:this.presenter.currentUser});
this.renderPage(a,function(){b.page.articleList(c);return c})};b.prototype.aboutVisit=function(){this.about("aboutVisit")};b.prototype.aboutBack=function(){this.about("aboutBack")};b.prototype.about=function(a){var b=this;a=this.updatePageCounter(a);var c=this.domain.about(this.presenter.currentUser);this.renderPage(a,function(){b.page.about(c);return c})};b.prototype.profileVisit=function(a){this.profile(a,"profileVisit")};b.prototype.profileBack=function(a){this.profile(a,"profileBack")};b.prototype.profile=
function(a,b){return f(this,void 0,void 0,function(){var e=this,h,d,f,g,l;return c(this,function(c){switch(c.label){case 0:return h=this.updatePageCounter(b),[4,this.domain.profile().get({uid:a,currentUser:this.presenter.currentUser})];case 1:d=c.sent();f=d.code;g=d.presenter;if(l=d.err)return this.renderError(h,f,l),[2];this.renderPage(h,function(){e.page.profile(g);return g});return[2]}})})};b.prototype.renderPage=function(a,b){try{a===this.pageCounter?this.presenter=b():this.logger.info(a+" !== "+
this.pageCounter)}catch(r){this.renderError(a,500,r.message)}};b.prototype.renderError=function(a,b,c){this.logger.error("renderError: code="+b+"; error="+c);a===this.pageCounter?(this.presenter=a=w.ErrorPresenter.FromCode(b,this.presenter.currentUser),this.page.error(a)):this.logger.info(a+" !== "+this.pageCounter)};b.prototype.updatePageCounter=function(a){this.pageCounter++;this.logger.info(a+"; visitCount="+this.pageCounter);return this.pageCounter};b.prototype.onUserStateChanged=function(b){return f(this,
void 0,void 0,function(){var e,f,h,d,g;return c(this,function(c){switch(c.label){case 0:e=a.userBuilder.signedOut();b?(e=a.userBuilder.fromFirebase(b),this.logger.info("signed in as: "+e.name),this.presenter.currentUser=e,this.domain.profile().subscribe(b.uid)):(this.logger.info("signed out"),f=this.presenter.currentUser.uid,this.presenter.currentUser=e,this.domain.profile().unsubscribe(f));this.render();if(!e.signedIn)return[3,2];this.logger.info("getClaims()");return[4,this.domain.auth().getClaims(b)];
case 1:h=c.sent(),d=h.claims,(g=h.err)&&this.logger.error(g),this.presenter.currentUser=a.userBuilder.withClaims(this.presenter.currentUser,d),c.label=2;case 2:return this.render(),this.logger.setUser(this.presenter.currentUser),[2]}})})};b.prototype.render=function(){var a=this.presenter.path;this.logger.info("render path="+a);switch(a){case l.articleListPath:this.page.articleList(this.presenter);break;case l.aboutPath:this.page.about(this.presenter);break;case l.profilePath:this.page.profile(this.presenter);
break;case l.errorPath:this.page.error(this.presenter);break;default:this.logger.error("app.render() failed; path="+a+"  -  Not Found")}};return b}();b.App=g},function(g,b,e){var f=this&&this.__awaiter||function(a,b,c,e){return new (c||(c=Promise))(function(f,g){function h(a){try{d(e.next(a))}catch(n){g(n)}}function k(a){try{d(e["throw"](a))}catch(n){g(n)}}function d(a){a.done?f(a.value):(new c(function(b){b(a.value)})).then(h,k)}d((e=e.apply(a,b||[])).next())})},c=this&&this.__generator||function(a,
b){function c(a){return function(b){return e([a,b])}}function e(d){if(g)throw new TypeError("Generator is already executing.");for(;f;)try{if(g=1,l&&(k=l[d[0]&2?"return":d[0]?"throw":"next"])&&!(k=k.call(l,d[1])).done)return k;if(l=0,k)d=[0,k.value];switch(d[0]){case 0:case 1:k=d;break;case 4:return f.label++,{value:d[1],done:!1};case 5:f.label++;l=d[1];d=[0];continue;case 7:d=f.ops.pop();f.trys.pop();continue;default:if(!(k=f.trys,k=0<k.length&&k[k.length-1])&&(6===d[0]||2===d[0])){f=0;continue}if(3===
d[0]&&(!k||d[1]>k[0]&&d[1]<k[3]))f.label=d[1];else if(6===d[0]&&f.label<k[1])f.label=k[1],k=d;else if(k&&f.label<k[2])f.label=k[2],f.ops.push(d);else{k[2]&&f.ops.pop();f.trys.pop();continue}}d=b.call(a,f)}catch(n){d=[6,n],l=0}finally{g=k=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}var f={label:0,sent:function(){if(k[0]&1)throw k[1];return k[1]},trys:[],ops:[]},g,l,k,d;return d={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(d[Symbol.iterator]=function(){return this}),
d};Object.defineProperty(b,"__esModule",{value:!0});g=function(){function a(a){this.logger=a.logger;this.app=a.app;this.auth=a.domain.auth();this.auth.onAuthStatChanged(this.OnAuthStateChanged.bind(this));document.body.addEventListener("click",this)}a.prototype.handleEvent=function(a){try{var b=a.target;if("getAttribute"in b){var c=b.getAttribute("data-action");if(c)this[c+"On"+a.type](a)}}catch(h){this.logger.error(h)}};a.prototype.OnAuthStateChanged=function(a){this.app.onUserStateChanged(a)};a.prototype.signInWithGoogleOnclick=
function(a){return f(this,void 0,void 0,function(){var b,e,f;return c(this,function(c){switch(c.label){case 0:return a.preventDefault(),[4,this.auth.GooglePopup().signInWithPopup()];case 1:return b=c.sent(),e=b.currentUser,f=b.err,null===e&&this.logger.error("signInWithGoogleOnclick failed; error="+f),[2]}})})};a.prototype.signOutOnclick=function(a){return f(this,void 0,void 0,function(){var b;return c(this,function(c){switch(c.label){case 0:return a.preventDefault(),[4,this.auth.GooglePopup().signOut()];
case 1:return(b=c.sent())||this.logger.error("signOutOnclick failed!"),[2]}})})};a.prototype.cleanup=function(){document.body.removeEventListener("click",this)};return a}();b.ActionHandler=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var f=e(34);b.router=function(b){var a=f();a.get("/",function(a){"pushstate"===a.type?b.rootVisit():b.rootBack()});a.get("/about",function(a){"pushstate"===a.type?b.aboutVisit():b.aboutBack()});a.get("/profile/:uid",function(a){var c=a.params.uid;
"pushstate"===a.type?b.profileVisit(c):b.profileBack(c)});a.get("*",function(a){window.location.reload(!1)})}},function(g,b,e){(function(b){var c=function(){function a(a,b){"string"!==typeof a&&(a=a.toString(),a=a.slice(1,a.lastIndexOf("/")));return h(a,b)}function c(a,b){for(var d,c={},e=1,f=a.length;e<f;e++)(d=a[e])&&(c[b[e-1].name]=d);return c}function f(){this.parentNode.removeChild(this)}function g(){this._params={};this._paths={};b.addEventListener("popstate",this,!1);b.addEventListener("pushstate",
this,!1)}e(36);var h=e(37),u=g.prototype;u.get=function(b){var c=[],d=a(b,c);c=this._paths[d]||(this._paths[d]={keys:c,cb:[],re:d});d=1;for(var e=arguments.length;d<e;d++)c.cb.push(arguments[d]);return this};u.delete=function(b){var c=a(b,[]);c=this._paths[c];for(var d=1,e=arguments.length;d<e;d++){var f=arguments[d];f=c?c.cb.lastIndexOf(f):-1;-1<f&&c.cb.splice(f,1)}return this};u.use=function(a,b){a=[].concat(a);for(var d=0,c=a.length;d<c;d++)this.get(a[d],b);return this};u.param=function(a,b){a=
[].concat(a);for(var d=0,c=a.length;d<c;d++)this._params[a[d]]=b;return this};u.navigate=function(a,b){switch(!0){case !!b:switch(!0){case !!b.replace:case !!b.replaceState:history.replaceState(history.state,document.title,a)}break;case a===location.pathname+location.search:this.handleEvent({type:"samestate"});break;default:var d=document;b=d.documentElement;d=d.createElement("a");d.href=a;d.onclick=f;b.insertBefore(d,b.firstChild);d.click()}return this};u.handleEvent=function(a){var b=this._paths,
d;for(d in b)if(b.hasOwnProperty(d)){var e=b[d],f=e.re.exec(location.pathname);if(f){var g=[],h=[],l=this._params,z={params:c(f,e.keys),type:a.type},E=0,v=e.cb.length;for(d in z.params)l.hasOwnProperty(d)&&h.push(d);(function C(){h.length?(d=h.shift(),l[d](z,C,z.params[d])):function sa(){if(E<v){var a=e.cb[E++];0>g.lastIndexOf(a)?(g.push(a),a(z,sa)):sa()}}()})();break}}};return function(){return new g}}();g.exports=(b.hyperHTML||{}).app=c}).call(b,e(35))},function(g,b){b=function(){return this}();
try{b=b||Function("return this")()||(0,eval)("this")}catch(e){"object"===typeof window&&(b=window)}g.exports=b},function(g,b){document.addEventListener("click",function(b){var e=b.target;var c=(e.closest||function(a){for(;e&&e.nodeName!==a;)e=e.parentNode;return e}).call(e,"A");if(c&&/^(?:_self)?$/i.test(c.target)&&!c.hasAttribute("download")&&"external"!==c.getAttribute("rel")){var a=new URL(c.href);c=location;if(a.origin===c.origin){var g=a.pathname+a.search;a=a.hash;var w=!0;b.preventDefault();
if(g===c.pathname+c.search)/^#[a-z][a-z0-9.:_-]+$/i.test(a)&&(e=document.querySelector(a+',[name="'+a.slice(1)+'"]'))&&(b.preventDefault=function(){w=!1},setTimeout(function(){w&&e.scrollIntoView(!0)})),history.replaceState(history.state,document.title,g+a);else{var q=new CustomEvent("pushstate");q.state=c.href;setTimeout(function(){dispatchEvent(q);window.onpushstate&&onpushstate(q)});history.pushState(q.state,document.title,g+a)}}}},!0)},function(g,b,e){function f(a,b){var d=[],c=0,e=0,f="";b=b&&
b.delimiter||"/";for(var g;null!=(g=k.exec(a));){var h=g[0],l=g[1],p=g.index;f+=a.slice(e,p);e=p+h.length;if(l)f+=l[1];else{var q=a[e];h=g[2];l=g[3];var r=g[4],u=g[5],y=g[6];p=g[7];f&&(d.push(f),f="");q=null!=h&&null!=q&&q!==h;var A="+"===y||"*"===y;y="?"===y||"*"===y;g=g[2]||b;r=r||u;d.push({name:l||c++,prefix:h||"",delimiter:g,optional:y,repeat:A,partial:q,asterisk:!!p,pattern:r?r.replace(/([=!:$\/()])/g,"\\$1"):p?".*":"[^"+w(g)+"]+?"})}}e<a.length&&(f+=a.substr(e));f&&d.push(f);return d}function c(a){return encodeURI(a).replace(/[\/?#]/g,
function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()})}function a(a){return encodeURI(a).replace(/[?#]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()})}function l(b){for(var d=Array(b.length),e=0;e<b.length;e++)"object"===typeof b[e]&&(d[e]=new RegExp("^(?:"+b[e].pattern+")$"));return function(e,f){var g="";e=e||{};f=(f||{}).pretty?c:encodeURIComponent;for(var h=0;h<b.length;h++){var k=b[h];if("string"===typeof k)g+=k;else{var l=e[k.name];if(null==l)if(k.optional){k.partial&&
(g+=k.prefix);continue}else throw new TypeError('Expected "'+k.name+'" to be defined');if(r(l)){if(!k.repeat)throw new TypeError('Expected "'+k.name+'" to not repeat, but received `'+JSON.stringify(l)+"`");if(0===l.length)if(k.optional)continue;else throw new TypeError('Expected "'+k.name+'" to not be empty');for(var n=0;n<l.length;n++){var p=f(l[n]);if(!d[h].test(p))throw new TypeError('Expected all "'+k.name+'" to match "'+k.pattern+'", but received `'+JSON.stringify(p)+"`");g+=(0===n?k.prefix:
k.delimiter)+p}}else{p=k.asterisk?a(l):f(l);if(!d[h].test(p))throw new TypeError('Expected "'+k.name+'" to match "'+k.pattern+'", but received "'+p+'"');g+=k.prefix+p}}}return g}}function w(a){return a.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function q(a,b){a.keys=b;return a}function h(a,b,c){r(b)||(c=b||c,b=[]);c=c||{};for(var d=c.strict,e=!1!==c.end,f="",g=0;g<a.length;g++){var h=a[g];if("string"===typeof h)f+=w(h);else{var k=w(h.prefix),l="(?:"+h.pattern+")";b.push(h);h.repeat&&(l+="(?:"+
k+l+")*");l=h.optional?h.partial?k+"("+l+")?":"(?:"+k+"("+l+"))?":k+"("+l+")";f+=l}}a=w(c.delimiter||"/");g=f.slice(-a.length)===a;d||(f=(g?f.slice(0,-a.length):f)+"(?:"+a+"(?=$))?");return q(new RegExp("^"+(e?f+"$":f+(d&&g?"":"(?="+a+"|$)")),c.sensitive?"":"i"),b)}function u(a,b,c){r(b)||(c=b||c,b=[]);c=c||{};if(a instanceof RegExp){if(c=a.source.match(/\((?!\?)/g))for(var d=0;d<c.length;d++)b.push({name:d,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return q(a,
b)}if(r(a)){d=[];for(var e=0;e<a.length;e++)d.push(u(a[e],b,c).source);a=new RegExp("(?:"+d.join("|")+")",c.sensitive?"":"i");return q(a,b)}return h(f(a,c),b,c)}var r=e(38);g.exports=u;g.exports.parse=f;g.exports.compile=function(a,b){return l(f(a,b))};g.exports.tokensToFunction=l;g.exports.tokensToRegExp=h;var k=/(\\.)|([\/.])?(?:(?:\:(\w+)(?:\(((?:\\.|[^\\()])+)\))?|\(((?:\\.|[^\\()])+)\))([+*?])?|(\*))/g},function(g,b){g.exports=Array.isArray||function(b){return"[object Array]"==Object.prototype.toString.call(b)}}])}]);
