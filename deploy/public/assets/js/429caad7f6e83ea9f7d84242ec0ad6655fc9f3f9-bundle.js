/*
 (c) 2017 Andrea Giammarchi @WebReflection, (ISC)  Copyright (c) 2017, Andrea Giammarchi, @WebReflection  (C) 2017 Andrea Giammarchi - @WebReflection - ISC License */
'use strict';(function(M){function z(b){if(g[b])return g[b].exports;var e=g[b]={i:b,l:!1,exports:{}};M[b].call(e.exports,e,e.exports,z);e.l=!0;return e.exports}var g={};z.m=M;z.c=g;z.d=function(b,e,d){z.o(b,e)||Object.defineProperty(b,e,{configurable:!1,enumerable:!0,get:d})};z.n=function(b){var e=b&&b.__esModule?function(){return b["default"]}:function(){return b};z.d(e,"a",e);return e};z.o=function(b,e){return Object.prototype.hasOwnProperty.call(b,e)};z.p="";return z(z.s=0)})([function(M,z){(function(g){function b(d){if(e[d])return e[d].exports;
var c=e[d]={i:d,l:!1,exports:{}};g[d].call(c.exports,c,c.exports,b);c.l=!0;return c.exports}var e={};b.m=g;b.c=e;b.d=function(d,c,a){b.o(d,c)||Object.defineProperty(d,c,{configurable:!1,enumerable:!0,get:a})};b.n=function(d){var c=d&&d.__esModule?function(){return d["default"]}:function(){return d};b.d(c,"a",c);return c};b.o=function(d,c){return Object.prototype.hasOwnProperty.call(d,c)};b.p="";return b(b.s=18)})([function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(22);b.wire=
function(c,a){return d.wire(c,a)};b.bind=function(c){return d.bind(c)}},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function c(){}c.profile=function(a){return"/profile/"+a};c.nextArticles=function(a){var c={hasMore:!1,nextArticlesPath:"#"};return a&&""!==a?{hasMore:!0,nextArticlesPath:d.articles+"?page_token="+a}:c};c.article=function(a){return"/article/"+a};c.profileReqExp="/profile/:id";c.about="/about";c.articles="/";c.articleRegExp="/article/:id";c.error=
"/error";return c}();b.path=d},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function a(){}a.ago=function(a){a||(a=Date.now());return new c(a)};return a}();b.time=g;var d=[{name:"second",limit:60,in_seconds:1},{name:"minute",limit:3600,in_seconds:60},{name:"hour",limit:86400,in_seconds:3600},{name:"day",limit:604800,in_seconds:86400},{name:"week",limit:2629743,in_seconds:604800},{name:"month",limit:31556926,in_seconds:2629743},{name:"year",limit:null,in_seconds:31556926}],
c=function(){function a(a){this.now=a}a.prototype.time=function(a){var c=(this.now-a)/1E3;if(0>c)return"future";if(5>c)return"now";for(var h=0;h<d.length;h++)if(a=d[h],!a.limit||c<a.limit)return c=Math.floor(c/a.in_seconds),a=a.name,1<c&&(a+="s"),c+" "+a+" ago"};return a}();b.Ago=c},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(10),c=e(8);g=function(){function a(a){this.isPresenter=!0;this.snackbar=new c.HiddenSnackbar(1);this.popup=new d.HiddenPopup;this.pageLoader=a.pageLoader;
this.currentUser=a.currentUser;this.ago=a.ago}a.prototype.toJSON=function(){throw"must be implemented in subclass.";};a.prototype.init=function(a){this.title=a.title;this.path=a.path};return a}();b.Presenter=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function d(){}d.pageProgressBar="viperfire-progress-bar";d.errHighlight="error-highlight";d.highlight="highlight";d.error="error";d.hide="hide";d.show="show";d.empty="";d.neutral="";d.loading="loading";d.done="done";
d.blink="blink";d.slideInBottom="slide-in-bottom";d.slideOutBottom="slide-out-bottom";return d}();b.css=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(34);g=function(){function c(){}c.parseIdToken=function(a){try{return{claims:{admin:JSON.parse(d.base64.decodeUnicode(a.split(".")[1]))[c.adminClaim]},err:null}}catch(l){return{claims:c.defaultClaims,err:l.message}}};c.withClaims=function(a,c){return{signedIn:a.signedIn,uid:a.uid,name:a.name,email:a.email,claims:c}};c.signedOut=
function(){return{signedIn:!1,uid:"",name:"",email:"",claims:c.defaultClaims}};c.fromFirebase=function(a){return{signedIn:!0,uid:a.uid,name:a.displayName||"",email:a.email||"",claims:c.defaultClaims}};c.adminClaim="admin";c.defaultClaims={admin:!1};return c}();b.userBuilder=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(1),c=e(9),a=e(11),l=e(12),q=e(13),h=e(14);(function(a){a[a.Neutral=0]="Neutral";a[a.Loading=1]="Loading";a[a.Done=2]="Done"})(b.PageLoader||(b.PageLoader=
{}));b.getPresenter=function(){try{var a=JSON.parse(window.__INITIAL_STATE__);return f(a)}catch(m){return{presenter:null,errMessage:m.message}}};var f=function(f){try{switch(f.path){case d.path.articles:return{presenter:l.ArticleListPresenter.Init(f),errMessage:""};case d.path.articleRegExp:return{presenter:q.ArticlePresenter.Init(f),errMessage:""};case d.path.profileReqExp:return{presenter:c.ProfilePresenter.Init(f),errMessage:""};case d.path.about:return{presenter:a.AboutPresenter.Init(f),errMessage:""};
case d.path.error:return{presenter:h.ErrorPresenter.Init(f),errMessage:""};default:return{presenter:null,errMessage:f.path+" not found"}}}catch(m){return{presenter:null,errMessage:m.message}}}},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function d(){}d.closeSnackbar="closeSnackbar";d.closePopup="closePopup";d.signInWithGoogle="signInWithGoogle";d.signOut="signOut";return d}();b.onClick=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d;(function(c){c.slideIN=
"slide-in";c.blink="blink";c.clear="clear";c.slideOut="slide-out";c.hide="hide"})(d=b.state||(b.state={}));g=function(){return function(c){this.state=d.hide;this.text="";this.showAction=!1;this.action=this.actionText="";this.version=c}}();b.HiddenSnackbar=g;g=function(){return function(c){this.showAction=!1;this.action=this.actionText="";this.text="You are signed in as "+c.email}}();b.SignedInSnackbar=g},function(g,b,e){var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof
Array&&function(a,h){a.__proto__=h}||function(a,h){for(var f in h)h.hasOwnProperty(f)&&(a[f]=h[f])};return function(c,h){function f(){this.constructor=c}a(c,h);c.prototype=null===h?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(b,"__esModule",{value:!0});var c=e(1),a=e(2);g=function(b){function q(a){var f=b.call(this,a)||this;b.prototype.init.call(f,{title:"Profile",path:c.path.profileReqExp});f.userProfile=a.userProfile;return f}d(q,b);q.Next=function(h,f){return new q({pageLoader:h.pageLoader,
currentUser:h.currentUser,ago:a.time.ago(),userProfile:f})};q.Init=function(h){return new q({pageLoader:h.pageLoader,currentUser:h.currentUser,ago:a.time.ago(),userProfile:h.userProfile})};q.prototype.toJSON=function(){return JSON.stringify(this.toObject())};q.prototype.toObject=function(){return{pageLoader:this.pageLoader,title:this.title,isPresenter:this.isPresenter,path:this.path,currentUser:this.currentUser,userProfile:this.userProfile}};return q}(e(3).Presenter);b.ProfilePresenter=g},function(g,
b,e){Object.defineProperty(b,"__esModule",{value:!0});var d='<button type="btn" data-action="'+e(7).onClick.closePopup+'" tabindex="1">ok</button>';g=function(){return function(){this.show=!1;this.main=this.title="";this.footer=d}}();b.HiddenPopup=g;g=function(){return function(c){this.show=!0;this.footer=d;this.title=c.title;this.main="<p>"+c.main+"</p>"}}();b.ErrorPopup=g},function(g,b,e){var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,
h){a.__proto__=h}||function(a,h){for(var f in h)h.hasOwnProperty(f)&&(a[f]=h[f])};return function(c,h){function f(){this.constructor=c}a(c,h);c.prototype=null===h?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(b,"__esModule",{value:!0});var c=e(1),a=e(2);g=function(b){function e(a){a=b.call(this,a)||this;b.prototype.init.call(a,{title:"About",path:c.path.about});return a}d(e,b);e.Next=function(c){return new e({pageLoader:c.pageLoader,currentUser:c.currentUser,ago:a.time.ago()})};
e.Init=function(c){return new e({pageLoader:c.pageLoader,currentUser:c.currentUser,ago:a.time.ago()})};e.prototype.toJSON=function(){return JSON.stringify(this.toObject())};e.prototype.toObject=function(){return{pageLoader:this.pageLoader,title:this.title,isPresenter:this.isPresenter,path:this.path,currentUser:this.currentUser}};return e}(e(3).Presenter);b.AboutPresenter=g},function(g,b,e){var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,
c){a.__proto__=c}||function(a,c){for(var f in c)c.hasOwnProperty(f)&&(a[f]=c[f])};return function(c,h){function f(){this.constructor=c}a(c,h);c.prototype=null===h?Object.create(h):(f.prototype=h.prototype,new f)}}();Object.defineProperty(b,"__esModule",{value:!0});var c=e(1),a=e(2);g=function(b){function e(a){var f=b.call(this,a)||this;b.prototype.init.call(f,{title:"Articles",path:c.path.articles});f.articleList=a.articleList;return f}d(e,b);e.Next=function(c,f){return new e({pageLoader:c.pageLoader,
currentUser:c.currentUser,ago:a.time.ago(),articleList:f})};e.Init=function(c){return new e({pageLoader:c.pageLoader,currentUser:c.currentUser,ago:a.time.ago(),articleList:c.articleList})};e.prototype.toJSON=function(){return JSON.stringify(this.toObject())};e.prototype.toObject=function(){return{pageLoader:this.pageLoader,title:this.title,isPresenter:this.isPresenter,path:this.path,currentUser:this.currentUser,articleList:this.articleList}};return e}(e(3).Presenter);b.ArticleListPresenter=g},function(g,
b,e){var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var f in c)c.hasOwnProperty(f)&&(a[f]=c[f])};return function(c,d){function f(){this.constructor=c}a(c,d);c.prototype=null===d?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(b,"__esModule",{value:!0});var c=e(1),a=e(2);g=function(b){function e(a){var f=b.call(this,a)||this;b.prototype.init.call(f,{title:"Article",path:c.path.articleRegExp});
f.article=a.article;return f}d(e,b);e.Next=function(c,f){return new e({pageLoader:c.pageLoader,currentUser:c.currentUser,ago:a.time.ago(),article:f})};e.Init=function(c){return new e({pageLoader:c.pageLoader,currentUser:c.currentUser,ago:a.time.ago(),article:c.article})};e.prototype.toJSON=function(){return JSON.stringify(this.toObject())};e.prototype.toObject=function(){return{pageLoader:this.pageLoader,title:this.title,isPresenter:this.isPresenter,path:this.path,currentUser:this.currentUser,article:this.article}};
return e}(e(3).Presenter);b.ArticlePresenter=g},function(g,b,e){var d=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,c){a.__proto__=c}||function(a,c){for(var f in c)c.hasOwnProperty(f)&&(a[f]=c[f])};return function(c,d){function f(){this.constructor=c}a(c,d);c.prototype=null===d?Object.create(d):(f.prototype=d.prototype,new f)}}();Object.defineProperty(b,"__esModule",{value:!0});var c=e(1),a=e(2);g=function(b){function e(a){var f=b.call(this,
a)||this;b.prototype.init.call(f,{title:a.title,path:c.path.error});f.message=a.message;return f}d(e,b);e.FromCode=function(c,f){switch(c){case 404:return new e({pageLoader:f.pageLoader,currentUser:f.currentUser,ago:a.time.ago(),title:"Not Found",message:"Page Not Found"});default:return new e({pageLoader:f.pageLoader,currentUser:f.currentUser,ago:a.time.ago(),title:"Internal Error",message:"Internal Error"})}};e.Init=function(c){return new e({pageLoader:c.pageLoader,currentUser:c.currentUser,ago:a.time.ago(),
title:c.title,message:c.message})};e.prototype.toJSON=function(){return JSON.stringify(this.toObject())};e.prototype.toObject=function(){return{pageLoader:this.pageLoader,title:this.title,isPresenter:this.isPresenter,path:this.path,currentUser:this.currentUser,message:this.message}};return e}(e(3).Presenter);b.ErrorPresenter=g},function(g,b){g.exports=firebase},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function d(){}d.profile=function(c){return d.profiles+"/"+c};
d.error=function(c){return d.errors+"/"+c};d.article=function(c){return d.articles+"/"+c};d.profiles="profiles";d.errors="errors";d.articles="articles";return d}();b.path=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d;(function(c){c[c.OK=200]="OK";c[c.InternalError=500]="InternalError";c[c.NotFound=404]="NotFound"})(d=b.statusCode||(b.statusCode={}));b.domainNotFound=function(c){return{code:d.NotFound,err:c+" Not Found"}};b.domainInternalError=function(c,a){return{code:d.InternalError,
err:c+" Internal Error="+a}}},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(19),c=e(6),a=e(33),l=e(35),q=e(42);b=e(44);g=e(46);e=e(47);d=d.getClientConfig();a=a.log(d.isOnline);a.info("init app start");var h=document.getElementById("app");if(h){var f=c.getPresenter();c=f.presenter;f=f.errMessage;if(null===c)a.error("getPresenter() failed; error="+f);else{l=new l.Domain({logger:a});var t=l.auth().currentUser().getFromCache();f=t.currentUser;t=t.err;null===f?a.info("auth().currentUser().getFromCache() failed; reason="+
t):c.currentUser=f;q=new q.Page({view:d.view,body:h,presenter:c,logger:a});q.render();b=new b.App({domain:l,page:q,logger:a});new g.ActionHandler({app:b,domain:l,logger:a});e.router(b);a.info("init app done")}}else a.error("could not find id: #app")},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(20),c=e(28),a=e(29),l=e(30),q=e(31),h=e(32);b.getServerConfig=function(){return f()};b.getClientConfig=function(){return f()};var f=function(){var f={header:new l.HeaderView({logo:{name:"Viperfire",
url:"/"}}),articleList:new c.ArticleListView,about:new a.AboutView({hyperLink:{name:"HyperHTML",url:"https://github.com/WebReflection/hyperHTML"},viperLink:{name:"ViperHTML",url:"https://github.com/WebReflection/viperhtml"},links:[{name:"HyperHTML",url:"https://github.com/WebReflection/hyperHTML"},{name:"ViperHTML",url:"https://github.com/WebReflection/viperhtml"}]}),footer:new q.FooterView({links:[{name:"Home",url:"/"},{name:"About",url:"/about"}]})};return{isOnline:h.env.online,view:new d.View(f)}}},
function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(21),c=e(23),a=e(24),l=e(25),q=e(26),h=e(27);g=function(){function f(f){this.pageLoader=new d.PageLoaderView;this.snackbar=new c.SnackbarView;this.popup=new a.PopupView;this.article=new l.ArticleView;this.profile=new q.ProfileView;this.error=new h.ErrorView;this.header=f.header;this.footer=f.footer;this.articleList=f.articleList;this.about=f.about}f.prototype.renderArticleList=function(a,c){return this.render(a,c,this.articleList.render(c))};
f.prototype.renderArticle=function(a,c){return this.render(a,c,this.article.render(c))};f.prototype.renderProfile=function(a,c){return this.render(a,c,this.profile.render(c))};f.prototype.renderAbout=function(a,c){return this.render(a,c,this.about.render())};f.prototype.renderError=function(a,c){return this.render(a,c,this.error.render(c))};f.prototype.render=function(a,c,f){return d='\n            ;\n            ;\n            ;\n            <div class="container">\n                <header>;</header>\n                <main>;</main>\n                <footer>;</footer>\n            </div>\n        '.split(";"),
d.raw='\n            ;\n            ;\n            ;\n            <div class="container">\n                <header>;</header>\n                <main>;</main>\n                <footer>;</footer>\n            </div>\n        '.split(";"),a(d,[this.pageLoader.render(c)],[this.popup.render(c)],[this.snackbar.render(c)],[this.header.render(c)],[f],[this.footer.render(c)]);var d};return f}();b.View=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(0),c=e(6),a=e(4);g=function(){function e(){this.html=
d.wire(this)}e.prototype.render=function(d){var e=a.css.pageProgressBar;d.pageLoader===c.PageLoader.Loading&&(e=e+" "+a.css.loading);d.pageLoader===c.PageLoader.Done&&(e=e+" "+a.css.loading+" "+a.css.done);return f=['\n            <div class="','">\n                <div class="background-progress-bar"></div>\n            </div>\n        '],f.raw=['\n            <div class="','">\n                <div class="background-progress-bar"></div>\n            </div>\n        '],this.html(f,e);var f};return e}();
b.PageLoaderView=g},function(g,b){b=function(e,d){function c(c){return 2>arguments.length?null==c?G("html"):"string"==typeof c?b(null,c):"raw"in c?G("html")(c):"nodeType"in c?a(c):ha(c,"html"):("raw"in c?G("html"):b).apply(null,arguments)}function a(a){return f.bind(a)}function b(a,c){return 1>arguments.length?G("html"):null==a?G(c||"html"):ha(a,c||"html")}function g(){}function h(a,c){return this.node=a,this.childNodes=c,d.aura(this,c)}function f(a){var c=W.get(this);return c&&c.template===N(a)?
X.apply(c.updates,arguments):za.apply(this,arguments),this}function t(a,c,f){var d,e,k,b=a.ownerElement,n="data"===f,p=!n&&/^on/.test(f),A=n||y(b,f)&&!Aa.test(f),m=p?f.slice(2):"",h=A||p,w=A&&(n||f in b);return(p||w)&&(c.push(b,f),p&&(m===K||m===Y?ja.add(b):f.toLowerCase()in b&&(m=m.toLowerCase()))),A&&(w||(k=O.get(b),k||(k={_:Object.create(null),$:function(){O.delete(b);for(var a in this._)this._[a].$()}},O.set(b,k)),k._[f]={_:null,$:function(){w=!0;e(this._)}}),e=function(c){w?d!==c&&(d=c,b[f]!==
c&&(null==c?(b[f]=null,b.removeAttribute(f)):b[f]=c)):(a.value=c,k._[f]._=c,f in b&&k.$())}),p?function(a){d!==a&&(d&&b.removeEventListener(m,d,!1),d=a,a&&b.addEventListener(m,a,!1))}:A?e:function(c){d!==c&&(d=c,a.value!==c&&(null==c?h||(h=!0,b.removeAttributeNode(a)):(a.value=c,h&&(h=!1,b.setAttributeNode(a)))))}}function m(a){var c;return function(f){f!==c&&(c=f,a.textContent=f)}}function k(a,c,f){var d;return function B(b){switch(typeof b){case "string":case "number":case "boolean":var k=c.length;
1===k&&c[0].nodeType===Z?d!==b&&(d=b,c[0].textContent=b):(d=b,k?f.splice(0,k,a.ownerDocument.createTextNode(b)):c[0]=a.parentNode.insertBefore(a.ownerDocument.createTextNode(b),a));break;case "function":B(b(a.parentNode,c,0));break;case "object":case "undefined":if(null==b){d=b;B("");break}b instanceof g&&(b=b.render());default:if(d=b,ka(b))if(k=b.length,0===k)f.splice(0);else switch(typeof b[0]){case "string":case "number":case "boolean":B({html:b});break;case "function":for(var e=a.parentNode,n=
0;n<k;n++)b[n]=b[n](e,c,n);B(b.concat.apply([],b));break;case "object":ka(b[0])&&(b=b.concat.apply([],b));k=b[0];if(null!=k&&"then"in k){Promise.all(b).then(B);break}n=0;for(k=b.length;n<k;n++)b[n]instanceof g&&(b[n]=b[n].render());default:D(f,b)}else"ELEMENT_NODE"in b?D(f,b.nodeType===la?E.call(b.childNodes):[b]):null!=b&&"then"in b?b.then(B):"placeholder"in b?(B(b.placeholder),"text"in b?Promise.resolve(b.text).then(String).then(B):"any"in b?Promise.resolve(b.any).then(B):"html"in b?Promise.resolve(b.html).then(w).then(B):
Promise.resolve(v(b,B)).then(B)):"text"in b?B(String(b.text)):"any"in b?B(b.any):"html"in b?(b=[].concat(b.html).join(""),f.splice(0),b=(U in a?P:H)(a,b.replace(ma,na)),c.push.apply(c,b.childNodes),a.parentNode.insertBefore(b,a)):B("length"in b?E.call(b):v(b,B))}}}function n(a,c,b){for(var f,d=a.childNodes,k=d.length,e=0;e<k;e++)switch(f=d[e],f.nodeType){case I:for(var p,m=void 0,A=void 0,h=void 0,w=f,l=c,t=b,g=Object.create(null),ia=w.attributes,H=0,r=ia.length;H<r;H++)p=ia[H],p.value===F&&(h=p.name,
h in g?(w.removeAttributeNode(p),g[h].value="",w.setAttributeNode(g[h]),r--,H--):(A=t.shift().replace(/^(?:|[\S\s]*?\s)(\S+?)=['"]?$/,"$1"),m=w.attributes,g[h]=m[A]||m[A.toLowerCase()],l.push(x("attr",g[h],A))));n(f,c,b);break;case oa:f.textContent===F&&(b.shift(),c.push(x("any",f)));break;case Z:Ba.test(a.nodeName)&&pa.call(f.textContent)===V&&(b.shift(),c.push(x("text",a)))}}function p(a){return Ca[a]}function w(a){return{html:a}}function H(a,c){var b,f=a.ownerDocument;a=f.createElement(/<([a-z][a-z0-9]*(?:-[a-z0-9]+)+)[\s\S]*?>[\s\S]*?<\/\1>/i.test(c)?
"div":"template");var d="content"in a,k=!1;(d||(b=f.createDocumentFragment(),k=/^[^\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(c)),k)?(f=RegExp.$1,a.innerHTML="<table>"+c+"</table>",Q(b,E.call(a.querySelectorAll(f)))):(a.innerHTML=c,d?b=a.content:Q(b,E.call(a.childNodes)));return b}function P(a,c){var b=a.ownerDocument;a=b.createDocumentFragment();R||aa?(b=b.createElement("div"),b.innerHTML='<svg xmlns="'+ba+'">'+c+"</svg>",Q(a,E.call(b.firstChild.childNodes))):(b=b.createElementNS(ba,
"svg"),b.innerHTML=c,Q(a,E.call(b.childNodes)));return a}function r(a,c){for(var b,f,d=c===K,k=0,e=a.length;k<e;k++)f=a[k],f.nodeType===I&&(b=u(f,d,c,b))}function u(a,c,b,f){if(ja.has(a))a.dispatchEvent(f||(f=new qa(b)));else if(c&&O.has(a))O.get(a).$();else{a=L(a);for(var d=0,k=a.length;d<k;d++)f=u(a[d],c,b,f)}return f}function y(a,b){var f=!(U in a);if(f&&/-/.test(a.nodeName)){var d=c.document;(d=(d=d.customElements||d.defaultView.customElements)&&d.get(a.nodeName.toLowerCase()))&&(a=d.prototype)}return f&&
b in a}function v(a,c){for(var b,f=0,d=ca.length;f<d;f++)if(b=ca[f],a.hasOwnProperty(b))return da[b](a[b],c)}function C(a,c){var b="_"+a+"$";return{get:function(){return this[b]||(this[a]=c.call(this,a))},set:function(a){Da(this,b,{configurable:!0,value:a})}}}function D(a,b){var f=0,k=a.length;if(b.length!==k)d(a,b,c.MAX_LIST_SIZE);else for(;f<k--;f++)if(a[k]!==b[k]||a[f]!==b[f])return void d(a,b,c.MAX_LIST_SIZE)}function z(a){for(var c=0,b=a.length;c<b;c++)a[c++].removeAttribute(a[c])}function S(a,
c,b,f){switch(a.type){case "any":var d=k(c,f,new h(c,f));break;case "attr":d=t(c,b,a.name);break;case "text":d=m(c)}return d}function x(a,c,b){var f=[];switch(c.nodeType){case I:case la:var d=c;break;case oa:d=c.parentNode;f.unshift("childNodes",f.indexOf.call(d.childNodes,c));break;default:d=c.ownerElement,f.unshift("attributes",c.name)}for(c=d;d=d.parentNode;c=d)f.unshift("children",f.indexOf.call(L(d),c));return{type:a,path:f,name:b}}function M(a){var c="_"+a.join(V);return ra[c]||(ra[c]=a)}function sa(a,
c){var b=c.previousSibling;b&&b.nodeType===Z&&(a.removeChild(b),sa(a,c))}function X(){for(var a=1,c=arguments.length;a<c;a++)this[a-1](arguments[a])}function za(a){a=N(a);var c;if(!(c=ta.get(a))){c=a;var b=[];var f=c.join(V);f=(U in this?P:H)(this,f.replace(ma,na));var d={fragment:f,paths:b};c=(n(f,b,c.slice()),ta.set(c,d),d)}b=c;if(ea){c=ua(b.fragment);b=b.paths;d=[];for(var k=[],e=0,p=b.length;e<p;e++)f=b[e],d[e]=S(f,fa(c,f.path),k,[]);b=(z(k),d);W.set(this,{template:a,updates:b});X.apply(b,arguments);
this.textContent="";this.appendChild(c)}else{c=b.fragment;b=b.paths;d=[];k=[];e=0;for(p=b.length;e<p;e++){f=[];var m=b[e];var h=e,w=m,g=this,l=c,t=f,r=g,q=g.ownerDocument;m=m.path;for(var u=fa(l,m),A=0,y=m.length;A<y;A++)switch(m[A++]){case "attributes":r=u.name;g.hasAttribute(r)||g.setAttribute(r,"");r=g.attributes[r];break;case "childNodes":var v=L(g),D=L(u.parentNode),C=(r=Ea(u))?m.indexOf.call(D,r)+1:-1,x=(r=va(u))?m.indexOf.call(D,r):-1;switch(r=q.createComment(F),!0){case 0>x:x=v.length;break;
case 0>C:C=0;default:x=-(D.length-x)}t.push.apply(t,E.call(v,C,x));t.length?(v=g,x=r,(D=va(t[t.length-1]))?v.insertBefore(x,D):v.appendChild(x)):(D=g,C=r,(v=E.call(v,x)[0])?D.insertBefore(C,v):D.appendChild(C));0===t.length&&sa(g,r);break;default:g=r=L(g)[m[A]]||g.appendChild(g.ownerDocument.createElement(fa(l,m.slice(0,A+1)).nodeName))}d[h]=S(w,r,k,f)}b=(z(k),d);W.set(this,{template:a,updates:b});X.apply(b,arguments)}}function G(b){function f(c){p=c.createDocumentFragment();n="svg"===b?c.createElementNS(ba,
"svg"):p;m=a(n)}function d(){if(h){h=!1;"svg"===b&&Q(p,E.call(n.childNodes));for(var a,c=[],f=p.childNodes,d=0,k=f.length;d<k;d++)a=f[d],a.nodeType!==I&&0===pa.call(a.textContent).length||c.push(a);e=1===c.length?c[0]:c}return e}var k,e,n,p,m,h,g;return"adopt"===b?function(a){var e=arguments;return a=N(a),g!==a&&(h=!0,g=a,k=function(a,k,g){return h&&(g<k.length?(n=k[g],p={ownerDocument:n.ownerDocument,childNodes:[n],children:[n]},m=c.adopt(p)):(U in a&&(b="svg"),f(a.ownerDocument))),m.apply(null,
e),d()}),k}:function(a){return a=N(a),g!==a&&(h=!0,g=a,f(c.document)),m.apply(null,arguments),d()}}function ha(a,c){var b=wa.get(a),f=c.indexOf(":"),d=c;return-1<f&&(d=c.slice(f+1),c=c.slice(0,f)||"html"),b||(b={},wa.set(a,b)),b[d]||(b[d]=G(c))}c.document=e;c.hyper=c;c.adopt=function(a){return function(){return ea=!1,f.apply(a,arguments),ea=!0,a}};c.bind=a;c.define=function(a,c){a in da||ca.push(a);da[a]=c};c.escape=function(a){return a.replace(/[&<>'"]/g,p)};c.wire=b;c.Component=g;Object.defineProperties(g.prototype,
{handleEvent:{value:function(a){var c=a.currentTarget;this["getAttribute"in c&&c.getAttribute("data-call")||"on"+a.type](a)}},html:C("html",G),svg:C("svg",G),state:C("state",function(){return this.defaultState}),defaultState:{get:function(){return{}}},setState:{value:function(a){var c=this.state;a="function"==typeof a?a.call(this,c):a;for(var b in a)c[b]=a[b];this.render()}}});var I=1,Z=3,oa=8,la=11,U="ownerSVGElement",ba="http://www.w3.org/2000/svg",Aa=/^style$/i,Ba=/^style|textarea$/i,F="_hyper: "+
(Math.random()*new Date|0)+";",V="\x3c!--"+F+"--\x3e";h.prototype.splice=function(a){var c=this.node;for(var b=this.childNodes,f=b[a+(arguments[1]||0)]||c,d=b.splice.apply(b,arguments),k=c.parentNode,e=0,n=d.length;e<n;e++)c=d[e],0>b.indexOf(c)&&k.removeChild(c);if(e=2,n=arguments.length,e<n){if(1==n-e)c=arguments[e];else for(c=k.ownerDocument.createDocumentFragment();e<n;)c.appendChild(arguments[e++]);k.insertBefore(c,f)}return d};var J=e.createDocumentFragment(),Fa="object"==typeof navigator&&/Firefox\/(\d+)/.test(navigator.userAgent)&&
55>parseFloat(RegExp.$1),R=function(){var a=e.createElement("p");return a.innerHTML='<i data-i="" class=""></i>',/class/i.test(a.firstChild.attributes[0].name)}(),aa=!("children"in J),N=function(a){return(N=a.propertyIsEnumerable("raw")||Fa?M:function(a){return a})(a)},E=[].slice,Ca={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},K="connected",Y="dis"+K;try{new Event(K);var qa=Event}catch(A){qa=function(a){var b=c.document.createEvent("Event");return b.initEvent(a,!1,!1),b}}try{(new MutationObserver(function(a){for(var c,
b=0,f=a.length;b<f;b++)c=a[b],r(c.removedNodes,Y),r(c.addedNodes,K)})).observe(e,{subtree:!0,childList:!0})}catch(A){e.addEventListener("DOMNodeInserted",function(a){r([a.target],K)},!1),e.addEventListener("DOMNodeRemoved",function(a){r([a.target],Y)},!1)}var T=typeof WeakMap==typeof T?function(){return{delete:function(a){delete a[F]},get:function(a){return a[F]},has:function(a){return F in a},set:function(a,c){Object.defineProperty(a,F,{configurable:!0,value:c})}}}:WeakMap,xa=typeof WeakSet==typeof xa?
function(){var a=new T;return{add:function(c){a.set(c,!0)},has:function(c){return!0===a.get(c)}}}:WeakSet,ya=typeof Map==typeof ya?function(){var a=[],c=[];return{get:function(b){return c[a.indexOf(b)]},set:function(b,f){c[a.push(b)-1]=f}}}:Map,ka=Array.isArray||function(){var a={}.toString,c=a.call([]);return function(b){return a.call(b)===c}}(),pa="_hyper: ".trim||function(){return this.replace(/^\s+|\s+$/g,"")},Da=Object.defineProperty,da={},ca=[],ra={},Q="append"in J?function(a,c){a.append.apply(a,
c)}:function(a,c){for(var b=0,f=c.length;b<f;b++)a.appendChild(c[b])},L=aa||R?function(a){for(var c=[],b=a.childNodes,f=0,d=0,k=b.length;d<k;d++)a=b[d],a.nodeType===I&&(c[f++]=a);return c}:function(a){return a.children},fa=R||aa?function(a,c){for(var b,f=0,d=c.length;f<d;f++)switch(b=c[f++]){case "children":a=L(a)[c[f]];break;default:a=a[b][c[f]]}return a}:function(a,c){for(var b=0,f=c.length;b<f;b++)a=a[c[b++]][c[b]];return a},ma=/(<[a-z]+[a-z0-9:_-]*)((?:[^\S]+[^ \f\n\r\t\/>"'=]+(?:=(?:'.*?'|".*?"|<.+?>|\S+))?)+)([^\S]*\/?>)/gi,
Ga=new RegExp("([^\\S]+[^ \\f\\n\\r\\t\\/>\"'=]+=)(['\"]?)"+V+"\\2","gi"),na=function(a,c,b,f){return c+b.replace(Ga,Ha)+f},Ha=function(a,c,b){return c+(b||'"')+F+(b||'"')},ja=new xa,W=new T,wa=new T,ta=new ya,O=new T,ea=!0,ua=function(){return J.appendChild(J.ownerDocument.createTextNode("g")),J.appendChild(J.ownerDocument.createTextNode("")),1===J.cloneNode(!0).childNodes.length?function(a){var c=a.cloneNode();a=a.childNodes||[];for(var b=0,f=a.length;b<f;b++)c.appendChild(ua(a[b]));return c}:function(a){return a.cloneNode(!0)}}(),
va=R?function(a){for(;a=a.nextSibling;)if(a.nodeType===I)return a}:function(a){return a.nextElementSibling},Ea=R?function(a){for(;a=a.previousSibling;)if(a.nodeType===I)return a}:function(a){return a.previousElementSibling};return c.MAX_LIST_SIZE=1E3,c}(document,function(){function b(b,f,e){var m=b.length,k=f.length;e=(e||1/0)<Math.sqrt((m||1)*(k||1));if(1>m||e)b=void((k||e)&&b.splice.apply(b,[0,m].concat(f)));else if(1>k)b=void b.splice(0);else{var n=b.length+1,p=f.length+1,h=0,l=0,t=0,r=0;m=new q(n*
p);for(m[0]=0;++h<p;)m[h]=h;for(;++l<n;){var u=h=0;var y=r;r=l*p;for(m[r+h]=l;++h<p;){k=m[y+h]+1;e=m[r+u]+1;var v=m[y+u]+(b[t]==f[u]?0:1);m[r+h]=k<e?k<v?k:v:e<v?e:v;++u}t=l}k=[];n=f.length+1;p=b.length+1-1;for(h=n-1;h&&p;)l=p*n+h,u=l-n,e=m[l],v=m[u],l=m[l-1],u=m[u-1],u<=l&&u<=v&&u<=e?(h--,p--,u<e&&d(k,g,h,p,1,[f[h]])):l<=v&&l<=e?(h--,d(k,a,h,p,0,[f[h]])):(p--,d(k,c,h,p,1,[]));for(;h--;)d(k,a,h,p,0,[f[h]]);for(;p--;)d(k,c,h,p,1,[]);v=0;n=1;if(p=k.length){for(e=m=k[0];n<p;)f=k[n++],m.type===f.type&&
1>=f.x-m.x&&1>=f.y-m.y?(e.count+=f.count,e.items=e.items.concat(f.items)):(b.splice.apply(b,[e.y+v,e.count].concat(e.items)),v+=e.type===a?e.items.length:e.type===c?-e.count:0,e=f),m=f;b.splice.apply(b,[e.y+v,e.count].concat(e.items))}b=void 0}return b}function d(a,c,b,d,e,n){a.unshift({type:c,x:b,y:d,count:e,items:n})}var c="del",a="ins",g="sub",q=/^u/.test(typeof Int32Array)?Array:Int32Array;return b.aura=function(a,c){var b=c.splice;return c.splice=function k(){c.splice=b;var f=a.splice.apply(a,
arguments);return c.splice=k,f},c},b}());try{g.exports=b}catch(e){}},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(0),c=e(4),a=e(8),l=e(7);g=function(){function b(){this.html=d.wire(this)}b.prototype.render=function(b){b=b.snackbar;var f="snackbar",d="snackbar-container";switch(b.state){case a.state.hide:f=f+" "+c.css.hide;break;case a.state.blink:d=d+" "+c.css.blink;break;case a.state.slideIN:d=d+" "+c.css.slideInBottom;break;case a.state.slideOut:d=d+" "+c.css.slideOutBottom}var e=
"snackbar-action "+c.css.hide;b.showAction&&(e="snackbar-action");return k='\n            <div class=";">\n                <div class=";">\n                    <span class="snackbar-message">;</span>\n                    <span class=";">\n                        <a href="#" class="hide">;</a>\n                     </span>\n                    <span class="snackbar-close">\n                        <svg xmlns="http://www.w3.org/2000/svg" \n                            fill="#000000" \n                            data-action=";"\n                            height="24" \n                            viewBox="0 0 24 24" \n                            width="24">\n                            <path class="clear" \n                                  data-action=";"\n                                  d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>\n                            <path d="M0 0h24v24H0z" fill="none"/>\n                        </svg>\n                    </span>\n                </div>\n            </div>\n        '.split(";"),
k.raw='\n            <div class=";">\n                <div class=";">\n                    <span class="snackbar-message">;</span>\n                    <span class=";">\n                        <a href="#" class="hide">;</a>\n                     </span>\n                    <span class="snackbar-close">\n                        <svg xmlns="http://www.w3.org/2000/svg" \n                            fill="#000000" \n                            data-action=";"\n                            height="24" \n                            viewBox="0 0 24 24" \n                            width="24">\n                            <path class="clear" \n                                  data-action=";"\n                                  d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>\n                            <path d="M0 0h24v24H0z" fill="none"/>\n                        </svg>\n                    </span>\n                </div>\n            </div>\n        '.split(";"),
this.html(k,f,d,b.text,e,b.actionText,l.onClick.closeSnackbar,l.onClick.closeSnackbar);var k};return b}();b.SnackbarView=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(0),c=e(4);g=function(){function a(){this.html=d.wire(this)}a.prototype.render=function(a){var b="modal "+c.css.hide;a=a.popup;a.show&&(b="modal");return d=['\n            <div class="','">\n                <div class="modal-overlay"></div>\n                <div class="modal-container">\n                    <div class="modal-center">\n                        <h3 class="modal-header">',
'</h3>\n                        <div class="modal-separator"></div>\n                        <div class="modal-main">','</div>\n                        <div class="modal-separator"></div>\n                        <div class="modal-footer">',"</div>\n                    </div>\n                </div>\n            </div>\n        "],d.raw=['\n            <div class="','">\n                <div class="modal-overlay"></div>\n                <div class="modal-container">\n                    <div class="modal-center">\n                        <h3 class="modal-header">',
'</h3>\n                        <div class="modal-separator"></div>\n                        <div class="modal-main">','</div>\n                        <div class="modal-separator"></div>\n                        <div class="modal-footer">',"</div>\n                    </div>\n                </div>\n            </div>\n        "],this.html(d,b,a.title,[a.main],[a.footer]);var d};return a}();b.PopupView=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(0);g=function(){function c(){this.html=
d.wire(this)}c.prototype.render=function(a){var c=a.ago;return b=['\n            <div class="article">\n                <h1>',"</h1>\n                <p>","</p>\n                <div>Created: ","</div>\n                <div>Published: ","</div>\n            </div>\n        "],b.raw=['\n            <div class="article">\n                <h1>',"</h1>\n                <p>","</p>\n                <div>Created: ","</div>\n                <div>Published: ","</div>\n            </div>\n        "],this.html(b,
a.article.title,a.article.bodyText,c.time(a.article.createTime),c.time(a.article.publishTime));var b};return c}();b.ArticleView=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(0);g=function(){function c(){this.html=d.wire(this)}c.prototype.render=function(a){return c=["\n            <h2>","</h2>\n            <p>Admin? ","</p>\n        "],c.raw=["\n            <h2>","</h2>\n            <p>Admin? ","</p>\n        "],this.html(c,a.userProfile.name,a.userProfile.admin);var c};
return c}();b.ProfileView=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(0);g=function(){function c(){this.html=d.wire(this)}c.prototype.render=function(a){return c=['\n            <div class="page-error">\n                <p>',"</p>\n            </div>\n        "],c.raw=['\n            <div class="page-error">\n                <p>',"</p>\n            </div>\n        "],this.html(c,a.message);var c};return c}();b.ErrorView=g},function(g,b,e){Object.defineProperty(b,"__esModule",
{value:!0});var d=e(0),c=e(1),a=e(4);g=function(){function b(){this.html=d.wire(this)}b.prototype.render=function(b){var e=0<b.articleList.length,f=c.path.nextArticles(b.articleList.pageToken),g=f.nextArticlesPath,m=a.css.hide;f.hasMore&&(m=a.css.show);var k=b.ago;return n=['\n            <div class="articles">\n                ',"\n            </div>"],n.raw=['\n            <div class="articles">\n                ',"\n            </div>"],this.html(n,e?(p=["<ul>\n                            ",'\n                        </ul>\n                        <a href="',
'" class="','">More</a>'],p.raw=["<ul>\n                            ",'\n                        </ul>\n                        <a href="','" class="','">More</a>'],d.wire(this,":article-list")(p,b.articleList.articles.map(function(a){return b=['\n                                <li>\n                                    <a href="','">',"</a>\n                                    <span>","</span>\n                                </li>"],b.raw=['\n                                <li>\n                                    <a href="',
'">',"</a>\n                                    <span>","</span>\n                                </li>"],d.wire(a)(b,c.path.article(a.id),a.id,k.time(a.createTime));var b}),g,m)):(l=["<p>Found no articles</p>"],l.raw=["<p>Found no articles</p>"],d.wire(this,":no-articles")(l)));var n,p,l};return b}();b.ArticleListView=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(0);g=function(){function c(a){this.hyperLink=a.hyperLink;this.viperLink=a.viperLink;this.links=a.links;this.html=
d.wire(this)}c.prototype.render=function(){return a='\n            <h1>About Viperfire</h1>\n            <p>A starter application hosted on Firebase and using \n                <a href=";">;</a> \n                on the client and <a href=";">;</a> on the server\n            </p>\n            <p>Technologies used:</p>\n            <ul>\n                ;\n            </ul>'.split(";"),a.raw='\n            <h1>About Viperfire</h1>\n            <p>A starter application hosted on Firebase and using \n                <a href=";">;</a> \n                on the client and <a href=";">;</a> on the server\n            </p>\n            <p>Technologies used:</p>\n            <ul>\n                ;\n            </ul>'.split(";"),
this.html(a,this.hyperLink.url,this.hyperLink.name,this.viperLink.url,this.viperLink.name,this.links.map(function(a,c){return b=['\n                    <li><a href="','">',"</a></li>"],b.raw=['\n                    <li><a href="','">',"</a></li>"],d.wire(a)(b,a.url,a.name);var b}));var a};return c}();b.AboutView=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(4),c=e(0),a=e(7);g=function(){function b(a){this.logo=a.logo;this.html=c.wire(this)}b.prototype.render=function(c){var b=
this.logo;if(c.currentUser.signedIn){var f="header-account-link "+d.css.hide;c="header-account-link"}else f="header-account-link",c="header-account-link "+d.css.hide;return e='\n            <a href=";" class="header-logo">;</a>\n            <div class="header-account">\n                <div class=";">\n                    <a href="#sign-in" data-action=";">Sign In with Google</a>\n                </div>\n                <div class=";">\n                    <a href="#sign-out" data-action=";">Sign Out</a>\n                </div>\n            </div>'.split(";"),
e.raw='\n            <a href=";" class="header-logo">;</a>\n            <div class="header-account">\n                <div class=";">\n                    <a href="#sign-in" data-action=";">Sign In with Google</a>\n                </div>\n                <div class=";">\n                    <a href="#sign-out" data-action=";">Sign Out</a>\n                </div>\n            </div>'.split(";"),this.html(e,b.url,b.name,f,a.onClick.signInWithGoogle,c,a.onClick.signOut);var e};return b}();b.HeaderView=
g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(0),c=e(1);g=function(){function a(a){this.html=d.wire(this);this.links=a.links}a.prototype.render=function(a){var b=[];a.currentUser.signedIn&&(b[0]={name:"My Profile",url:c.path.profile(a.currentUser.uid)});return e=['\n            <ul class="footer-list">\n                ',"\n                \n                ","\n            </ul>"],e.raw=['\n            <ul class="footer-list">\n                ',"\n                \n                ",
"\n            </ul>"],this.html(e,this.links.map(function(a,c){return b=['\n                    <li class="footer-list-item"><a href="','">',"</a></li>"],b.raw=['\n                    <li class="footer-list-item"><a href="','">',"</a></li>"],d.wire(a)(b,a.url,a.name);var b}),b.map(function(a,c){return b=['\n                    <li class="footer-list-item"><a href="','">',"</a></li>"],b.raw=['\n                    <li class="footer-list-item"><a href="','">',"</a></li>"],d.wire(a)(b,a.url,a.name);
var b}));var e};return a}();b.FooterView=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){}b.online=!0;return b}();b.env=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});g=e(5);window.__VIPER__=window.__VIPER__||{user:g.userBuilder.signedOut()};var d=function(){function a(){}a.info=function(a){};a.error=function(a){};a.setUser=function(a){};return a}(),c=function(){function a(){}a.info=function(a){console.info(a)};a.error=function(a){console.error(a)};
a.setUser=function(a){window.__VIPER__.user=a};return a}();b.log=function(a){return a?d:c}},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){}b.decodeUnicode=function(c){return decodeURIComponent(atob(c).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""))};return b}();b.base64=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(15),c=e(36),a=e(38),l=e(41);g=function(){function b(b){this.authDomain=
new l.AuthDomain(d.app());this.profileDomain=new c.ProfileDomain({firestore:d.firestore(),logger:b.logger});this.articleDomain=new a.ArticleDomain({firestore:d.firestore()})}b.prototype.auth=function(){return this.authDomain};b.prototype.article=function(){return this.articleDomain};b.prototype.profile=function(){return this.profileDomain};return b}();b.Domain=g},function(g,b,e){var d=this&&this.__awaiter||function(a,c,b,f){return new (b||(b=Promise))(function(d,e){function k(a){try{p(f.next(a))}catch(y){e(y)}}
function n(a){try{p(f["throw"](a))}catch(y){e(y)}}function p(a){a.done?d(a.value):(new b(function(c){c(a.value)})).then(k,n)}p((f=f.apply(a,c||[])).next())})},c=this&&this.__generator||function(a,c){function b(a){return function(c){return f([a,c])}}function f(b){if(e)throw new TypeError("Generator is already executing.");for(;d;)try{if(e=1,m&&(g=m[b[0]&2?"return":b[0]?"throw":"next"])&&!(g=g.call(m,b[1])).done)return g;if(m=0,g)b=[0,g.value];switch(b[0]){case 0:case 1:g=b;break;case 4:return d.label++,
{value:b[1],done:!1};case 5:d.label++;m=b[1];b=[0];continue;case 7:b=d.ops.pop();d.trys.pop();continue;default:if(!(g=d.trys,g=0<g.length&&g[g.length-1])&&(6===b[0]||2===b[0])){d=0;continue}if(3===b[0]&&(!g||b[1]>g[0]&&b[1]<g[3]))d.label=b[1];else if(6===b[0]&&d.label<g[1])d.label=g[1],g=b;else if(g&&d.label<g[2])d.label=g[2],d.ops.push(b);else{g[2]&&d.ops.pop();d.trys.pop();continue}}b=c.call(a,d)}catch(y){b=[6,y],m=0}finally{e=g=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}var d=
{label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},e,m,g,h;return h={next:b(0),"throw":b(1),"return":b(2)},"function"===typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h};Object.defineProperty(b,"__esModule",{value:!0});var a=e(16),l=e(17),q=e(37);g=function(){function b(a){this.db=a.firestore;this.logger=a.logger;this.cache=new h;this.subscriptions=new f}b.prototype.get=function(b){return d(this,void 0,void 0,function(){var f,d,e,g,m,h,r,t,y,v,C;return c(this,
function(c){switch(c.label){case 0:f=this.cache[b.uid];d=a.path.profile(b.uid);if(f)return this.logger.info("cache hit "+d),[2,{code:l.statusCode.OK,userProfile:f,err:null}];this.logger.info("cache miss "+d);c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.db.doc(d).get()];case 2:e=c.sent();if(!e.exists)return g=l.domainNotFound(d),m=g.code,h=g.err,r=q.userProfileBuilder.empty(b.uid),[2,{code:m,userProfile:r,err:h}];t=q.userProfileBuilder.fromDB(e.data());return[2,{code:l.statusCode.OK,userProfile:t,
err:null}];case 3:return y=c.sent(),v=l.domainInternalError(d,y.message),m=v.code,h=v.err,C=q.userProfileBuilder.empty(b.uid),[2,{code:m,userProfile:C,err:h}];case 4:return[2]}})})};b.prototype.subscribe=function(b){var c=this,f=a.path.profile(b);this.logger.info("subscribe to "+f);this.subscriptions[b]=this.db.doc(f).onSnapshot(function(a){a.exists?(c.logger.info("add "+f+" to cache"),c.cache[b]=q.userProfileBuilder.fromDB(a.data()),c.logger.info(f+" updated on "+(a.metadata.hasPendingWrites?"Client":
"Server"))):c.unsubscribe(b)})};b.prototype.unsubscribe=function(b){if(""!==b){var c=a.path.profile(b);this.logger.info("unsubscribe to "+c);delete this.cache[b];if(c=this.subscriptions[b])this.logger.info("calling unsubscribe"),c(),this.logger.info("called unsubscribe"),delete this.subscriptions[b]}};return b}();b.ProfileDomain=g;var h=function(){return function(){}}(),f=function(){return function(){}}()},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(5);g=function(){function a(){}
a.empty=function(a){return{uid:a,name:"",email:"",admin:!1,claims:d.userBuilder.defaultClaims}};a.fromDB=function(a){var b=c(a.claims);return{uid:a.uid,name:a.name,email:a.email,admin:b[d.userBuilder.adminClaim],claims:b}};a.fromUser=function(a){var b=c(a.claims);return{uid:a.uid,name:a.name,email:a.email,admin:b[d.userBuilder.adminClaim],claims:b}};a.toUser=function(a,b){return{signedIn:b,uid:a.uid,name:a.name,email:a.email,claims:a.claims}};return a}();b.userProfileBuilder=g;var c=function(a){return a&&
a.hasOwnProperty(d.userBuilder.adminClaim)?a:d.userBuilder.defaultClaims}},function(g,b,e){var d=this&&this.__awaiter||function(a,b,c,d){return new (c||(c=Promise))(function(f,e){function k(a){try{g(d.next(a))}catch(u){e(u)}}function n(a){try{g(d["throw"](a))}catch(u){e(u)}}function g(a){a.done?f(a.value):(new c(function(b){b(a.value)})).then(k,n)}g((d=d.apply(a,b||[])).next())})},c=this&&this.__generator||function(a,b){function c(a){return function(b){return f([a,b])}}function f(c){if(e)throw new TypeError("Generator is already executing.");
for(;d;)try{if(e=1,g&&(h=g[c[0]&2?"return":c[0]?"throw":"next"])&&!(h=h.call(g,c[1])).done)return h;if(g=0,h)c=[0,h.value];switch(c[0]){case 0:case 1:h=c;break;case 4:return d.label++,{value:c[1],done:!1};case 5:d.label++;g=c[1];c=[0];continue;case 7:c=d.ops.pop();d.trys.pop();continue;default:if(!(h=d.trys,h=0<h.length&&h[h.length-1])&&(6===c[0]||2===c[0])){d=0;continue}if(3===c[0]&&(!h||c[1]>h[0]&&c[1]<h[3]))d.label=c[1];else if(6===c[0]&&d.label<h[1])d.label=h[1],h=c;else if(h&&d.label<h[2])d.label=
h[2],d.ops.push(c);else{h[2]&&d.ops.pop();d.trys.pop();continue}}c=b.call(a,d)}catch(u){c=[6,u],g=0}finally{e=h=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var d={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},e,g,h,l;return l={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l};Object.defineProperty(b,"__esModule",{value:!0});var a=e(39),l=e(16),q=e(17),h=e(40);g=function(){function b(a){this.limit=
3;this.db=a.firestore}b.prototype.get=function(b){return d(this,void 0,void 0,function(){var d,f,e,g,h,t,P,r;return c(this,function(c){switch(c.label){case 0:d=l.path.article(b),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.db.doc(d).get()];case 2:f=c.sent();if(!f.exists)return e=q.domainNotFound(d),g=e.code,h=e.err,[2,{code:g,article:a.articleBuilder.empty(b),error:h}];t=a.articleBuilder.fromDB(b,f.data());return[2,{code:q.statusCode.OK,article:t,error:null}];case 3:return P=c.sent(),r=q.domainInternalError(d,
P.message),g=r.code,h=r.err,[2,{code:g,article:a.articleBuilder.empty(b),error:h}];case 4:return[2]}})})};b.prototype.queryDraft=function(b){return{status:a.Status.Draft,limit:this.limit,pageToken:b||""}};b.prototype.queryPublished=function(b){return{status:a.Status.Published,limit:this.limit,pageToken:b||""}};b.prototype.all=function(b){return d(this,void 0,void 0,function(){var d,f,e,g,w,t,q,r,u,y,v,C;return c(this,function(c){switch(c.label){case 0:d=this.db.collection(l.path.articles).where("status",
"==",b.status).limit(b.limit);d=b.status===a.Status.Draft?d.orderBy("createTime","desc"):d.orderBy("publishTime","desc");f={articleList:{length:0,pageToken:"",articles:[]},domainError:null};if(""!==b.pageToken){e=h.parsePageToken(b.pageToken);g=e.pageToken;if(w=e.pageTokenError)return f.domainError="could not parse pageToken; error="+w,[2,f];d=d.orderBy("sortID").startAfter(g.time,g.sortID)}c.label=1;case 1:return c.trys.push([1,3,,4]),[4,d.get()];case 2:t=c.sent();if(t.empty)return[2,f];f.articleList.length=
t.docs.length;f.articleList.length>=b.limit&&(q=t.docs[f.articleList.length-1].data(),f.articleList.pageToken=q.status===a.Status.Draft?h.newPageToken(q.createTime,q.sortID):h.newPageToken(q.publishTime,q.sortID));r=0;for(u=t.docs;r<u.length;r++)y=u[r],v=a.articleBuilder.fromDB(y.id,y.data()),f.articleList.articles.push(v);return[2,f];case 3:return C=c.sent(),f.domainError="query article.all() failed; error="+C.message,[2,f];case 4:return[2]}})})};return b}();b.ArticleDomain=g},function(g,b,e){Object.defineProperty(b,
"__esModule",{value:!0});var d;(function(b){b.Draft="draft";b.Published="published"})(d=b.Status||(b.Status={}));g=function(){function b(){}b.setSortID=function(a,b){return{id:a.id,sortID:b,title:a.title,bodyText:a.bodyText,author:a.author,commentCount:a.commentCount,status:a.status,publishTime:a.publishTime,createTime:a.createTime,updateTime:a.updateTime}};b.empty=function(a){return{id:a,sortID:"",title:"",bodyText:"",author:"",commentCount:0,status:d.Draft,publishTime:0x8994df7bcc3c,createTime:Date.now(),
updateTime:Date.now()}};b.toDB=function(a){return{sortID:a.sortID,title:a.title,bodyText:a.bodyText,author:a.author,commentCount:a.commentCount,status:a.status,publishTime:a.publishTime,createTime:a.createTime,updateTime:a.updateTime}};b.fromDB=function(a,b){return{id:a,sortID:b.sortID,title:b.title,bodyText:b.bodyText,author:b.author,commentCount:b.commentCount,status:b.status,publishTime:b.publishTime,createTime:b.createTime,updateTime:b.updateTime}};b.hasError=function(a){return null};return b}();
b.articleBuilder=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});b.newPageToken=function(b,c){return b+"-"+c};b.parsePageToken=function(b){try{var c=b.split("-");return{pageToken:{time:parseInt(c[0],10),sortID:c[1]},pageTokenError:null}}catch(a){return{pageToken:{time:1,sortID:""},pageTokenError:a.message}}}},function(g,b,e){var d=this&&this.__awaiter||function(a,b,c,d){return new (c||(c=Promise))(function(f,e){function g(a){try{h(d.next(a))}catch(u){e(u)}}function k(a){try{h(d["throw"](a))}catch(u){e(u)}}
function h(a){a.done?f(a.value):(new c(function(b){b(a.value)})).then(g,k)}h((d=d.apply(a,b||[])).next())})},c=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;f;)try{if(e=1,g&&(h=g[c[0]&2?"return":c[0]?"throw":"next"])&&!(h=h.call(g,c[1])).done)return h;if(g=0,h)c=[0,h.value];switch(c[0]){case 0:case 1:h=c;break;case 4:return f.label++,{value:c[1],done:!1};case 5:f.label++;g=c[1];
c=[0];continue;case 7:c=f.ops.pop();f.trys.pop();continue;default:if(!(h=f.trys,h=0<h.length&&h[h.length-1])&&(6===c[0]||2===c[0])){f=0;continue}if(3===c[0]&&(!h||c[1]>h[0]&&c[1]<h[3]))f.label=c[1];else if(6===c[0]&&f.label<h[1])f.label=h[1],h=c;else if(h&&f.label<h[2])f.label=h[2],f.ops.push(c);else{h[2]&&f.ops.pop();f.trys.pop();continue}}c=b.call(a,f)}catch(u){c=[6,u],g=0}finally{e=h=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var f={label:0,sent:function(){if(h[0]&1)throw h[1];
return h[1]},trys:[],ops:[]},e,g,h,l;return l={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l};Object.defineProperty(b,"__esModule",{value:!0});var a=e(15),l=e(5);g=function(){function b(a){this.firebase=a;this.cache=new q(a.options)}b.prototype.getClaims=function(a){return d(this,void 0,void 0,function(){var b,f;return c(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,a.getIdToken()];case 1:return b=c.sent(),
[2,l.userBuilder.parseIdToken(b)];case 2:return f=c.sent(),[2,{claims:l.userBuilder.defaultClaims,err:f.message}];case 3:return[2]}})})};b.prototype.onAuthStatChanged=function(a){var b=this;this.firebase.auth().onAuthStateChanged(function(f){return d(b,void 0,void 0,function(){return c(this,function(b){a(f);return[2]})})})};b.prototype.currentUser=function(){return this.cache};b.prototype.GooglePopup=function(){var b=new a.auth.GoogleAuthProvider;return new h({firebase:this.firebase,provider:b})};
return b}();b.AuthDomain=g;var q=function(){function a(a){this.key="firebase:authUser:"+a.apiKey+":[DEFAULT]"}a.prototype.getFromCache=function(){if(!window.localStorage)return{currentUser:null,err:"no local storage in this browser"};var a=localStorage.getItem(this.key);if(!a)return{currentUser:null,err:"no user exists in local storage; apiKey="+this.key};try{var b=JSON.parse(a);return{currentUser:l.userBuilder.fromFirebase(b),err:""}}catch(k){return{currentUser:null,err:"local storage JSON.parse(text); test="+
a+"; error="+k.message}}};return a}(),h=function(){function a(a){this.firebase=a.firebase;this.provider=a.provider}a.prototype.signInWithPopup=function(){return d(this,void 0,void 0,function(){var a,b,f,d;return c(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,this.firebase.auth().signInWithPopup(this.provider)];case 1:return a=c.sent(),b=a.user,[2,{currentUser:l.userBuilder.fromFirebase(b),err:""}];case 2:return d=f=c.sent(),[2,{currentUser:null,err:d.message}];case 3:return[2]}})})};
a.prototype.signOut=function(){return d(this,void 0,void 0,function(){return c(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.firebase.auth().signOut()];case 1:return a.sent(),[2,!0];case 2:return a.sent(),[2,!1];case 3:return[2]}})})};return a}()},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(0),c=e(12),a=e(9),l=e(11),q=e(14),h=e(1),f=e(43),t=e(13);(function(){return function(){}})();g=function(){function b(a){this.pageNumber=0;this.renderBody=
d.bind(a.body);this.view=a.view;this.presenter=a.presenter;this.logger=a.logger}b.prototype.loading=function(a){f.loader.start(this);this.pageNumber++;this.logger.info("loading("+this.pageNumber+")="+a);return this.pageNumber};b.prototype.showArticleList=function(a,b){var f=this;this.showPage(a,function(){var a=c.ArticleListPresenter.Next(f.presenter,b);f.renderArticleList(a)})};b.prototype.renderArticleList=function(a){document.title=a.title;this.view.renderArticleList(this.renderBody,a);this.presenter=
a};b.prototype.showArticle=function(a,b){var c=this;this.showPage(a,function(){var a=t.ArticlePresenter.Next(c.presenter,b);c.renderArticle(a)})};b.prototype.renderArticle=function(a){document.title=a.title;this.view.renderArticle(this.renderBody,a);this.presenter=a};b.prototype.showProfile=function(b,c){var f=this;this.showPage(b,function(){var b=a.ProfilePresenter.Next(f.presenter,c);f.renderProfile(b)})};b.prototype.renderProfile=function(a){document.title=a.title;this.view.renderProfile(this.renderBody,
a);this.presenter=a};b.prototype.showAbout=function(a){var b=this;this.showPage(a,function(){var a=l.AboutPresenter.Next(b.presenter);b.renderAbout(a)})};b.prototype.renderAbout=function(a){this.view.renderAbout(this.renderBody,a);document.title=a.title;this.presenter=a};b.prototype.showPage=function(a,b){try{a===this.pageNumber?(f.loader.done(this),b(),f.loader.reset(this)):this.logger.info("cancel visit => "+a+" !== "+this.pageNumber)}catch(p){this.showError(a,500,p.message)}};b.prototype.showError=
function(a,b,c){this.logger.error("visit error; code="+b+"; error="+c);a===this.pageNumber?(f.loader.done(this),a=q.ErrorPresenter.FromCode(b,this.presenter),this.renderError(a),f.loader.reset(this)):this.logger.info("cancel error visit => "+a+" !== "+this.pageNumber)};b.prototype.renderError=function(a){this.view.renderError(this.renderBody,a);document.title=a.title;this.presenter=a};b.prototype.render=function(){try{switch(this.presenter.path){case h.path.articles:this.renderArticleList(this.presenter);
break;case h.path.articleRegExp:this.renderArticle(this.presenter);break;case h.path.about:this.renderAbout(this.presenter);break;case h.path.profileReqExp:this.renderProfile(this.presenter);break;case h.path.error:this.renderError(this.presenter);break;default:this.logger.error("page.Render() failed; error=path="+h.path+" not found")}}catch(k){this.logger.error("page.Render() failed; error="+k.message)}};return b}();b.Page=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=
e(6);g=function(){function b(){}b.start=function(a){b.resetNow(a);a.presenter.pageLoader=d.PageLoader.Loading;a.render()};b.reset=function(a){setTimeout(function(c){a.pageNumber===c&&b.resetNow(a)},300,a.pageNumber)};b.done=function(a){setTimeout(function(b){a.pageNumber===b&&(a.presenter.pageLoader===d.PageLoader.Loading&&(a.presenter.pageLoader=d.PageLoader.Done),a.render())},100,a.pageNumber)};b.resetNow=function(a){a.presenter.pageLoader!==d.PageLoader.Neutral&&(a.presenter.pageLoader=d.PageLoader.Neutral,
a.render())};return b}();b.loader=g},function(g,b,e){var d=this&&this.__awaiter||function(a,b,c,d){return new (c||(c=Promise))(function(f,e){function g(a){try{k(d.next(a))}catch(r){e(r)}}function h(a){try{k(d["throw"](a))}catch(r){e(r)}}function k(a){a.done?f(a.value):(new c(function(b){b(a.value)})).then(g,h)}k((d=d.apply(a,b||[])).next())})},c=this&&this.__generator||function(a,b){function c(a){return function(b){return f([a,b])}}function f(c){if(e)throw new TypeError("Generator is already executing.");
for(;d;)try{if(e=1,g&&(h=g[c[0]&2?"return":c[0]?"throw":"next"])&&!(h=h.call(g,c[1])).done)return h;if(g=0,h)c=[0,h.value];switch(c[0]){case 0:case 1:h=c;break;case 4:return d.label++,{value:c[1],done:!1};case 5:d.label++;g=c[1];c=[0];continue;case 7:c=d.ops.pop();d.trys.pop();continue;default:if(!(h=d.trys,h=0<h.length&&h[h.length-1])&&(6===c[0]||2===c[0])){d=0;continue}if(3===c[0]&&(!h||c[1]>h[0]&&c[1]<h[3]))d.label=c[1];else if(6===c[0]&&d.label<h[1])d.label=h[1],h=c;else if(h&&d.label<h[2])d.label=
h[2],d.ops.push(c);else{h[2]&&d.ops.pop();d.trys.pop();continue}}c=b.call(a,d)}catch(r){c=[6,r],g=0}finally{e=h=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var d={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},e,g,h,l;return l={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l};Object.defineProperty(b,"__esModule",{value:!0});var a=e(5),l=e(45),q=e(10);(function(){return function(){}})();g=
function(){function b(a){this.page=a.page;this.domain=a.domain;this.logger=a.logger;this.snackbar=new l.SnackbarHelper({page:this.page,logger:this.logger})}b.prototype.rootVisit=function(a){this.root(a,"rootVisit")};b.prototype.rootBack=function(a){this.root(a,"rootBack")};b.prototype.root=function(a,b){return d(this,void 0,void 0,function(){var d,f,e,g,h;return c(this,function(c){switch(c.label){case 0:return d=this.page.loading(b),f=this.domain.article().queryDraft(a),[4,this.domain.article().all(f)];
case 1:e=c.sent();g=e.articleList;if(h=e.domainError)return this.page.showError(d,500,h),[2];this.page.showArticleList(d,g);return[2]}})})};b.prototype.articleVisit=function(a){this.article(a,"articleVisit")};b.prototype.articleBack=function(a){this.article(a,"articleBack")};b.prototype.article=function(a,b){return d(this,void 0,void 0,function(){var d,f,e,g,h;return c(this,function(c){switch(c.label){case 0:return d=this.page.loading(b),[4,this.domain.article().get(a)];case 1:f=c.sent();e=f.code;
g=f.article;if(h=f.error)return this.page.showError(d,e,h),[2];this.page.showArticle(d,g);return[2]}})})};b.prototype.aboutVisit=function(){this.about("aboutVisit")};b.prototype.aboutBack=function(){this.about("aboutBack")};b.prototype.about=function(a){a=this.page.loading(a);this.page.showAbout(a)};b.prototype.profileVisit=function(a){this.profile(a,"profileVisit")};b.prototype.profileBack=function(a){this.profile(a,"profileBack")};b.prototype.profile=function(a,b){return d(this,void 0,void 0,function(){var d,
f,e,g,h;return c(this,function(c){switch(c.label){case 0:return d=this.page.loading(b),[4,this.domain.profile().get({uid:a})];case 1:f=c.sent();e=f.code;g=f.userProfile;if(h=f.err)return this.page.showError(d,e,h),[2];this.page.showProfile(d,g);return[2]}})})};b.prototype.onUserStateChanged=function(b){return d(this,void 0,void 0,function(){var d,f,e,g,h;return c(this,function(c){switch(c.label){case 0:d=a.userBuilder.signedOut();b?(d=a.userBuilder.fromFirebase(b),this.logger.info("signed in as: "+
d.name),this.page.presenter.currentUser=d,this.domain.profile().subscribe(b.uid),this.snackbar.showSignedIn(d.email)):(this.logger.info("signed out"),f=this.page.presenter.currentUser.uid,this.page.presenter.currentUser=d,this.domain.profile().unsubscribe(f));if(!d.signedIn)return[3,2];this.logger.info("getClaims()");return[4,this.domain.auth().getClaims(b)];case 1:e=c.sent(),g=e.claims,(h=e.err)&&this.logger.error(h),this.page.presenter.currentUser=a.userBuilder.withClaims(this.page.presenter.currentUser,
g),c.label=2;case 2:return this.page.render(),this.logger.setUser(this.page.presenter.currentUser),[2]}})})};b.prototype.hideSnackbar=function(){this.snackbar.close()};b.prototype.hidePopup=function(){this.logger.info("app.closePopup()");this.page.presenter.popup=new q.HiddenPopup;this.page.render()};b.prototype.showPopup=function(a){this.logger.info("app.showPopup()");this.page.presenter.popup=new q.ErrorPopup(a);this.page.render()};return b}();b.App=g},function(g,b,e){Object.defineProperty(b,"__esModule",
{value:!0});var d=e(8);g=function(){function b(a){this.page=a.page;this.logger=a.logger;this.clear=this.clear.bind(this);this.slideOut=this.slideOut.bind(this);this.hide=this.hide.bind(this)}b.prototype.showSignedIn=function(a){this.logger.info("snackbar.showSignedIn()");this.show(new d.SignedInSnackbar({email:a}))};b.prototype.close=function(){var a=this.page.presenter.snackbar.version+1;this.page.presenter.snackbar.version=a;this.slideOut(a)};b.prototype.nextState=function(){var a=this.page.presenter.snackbar.state;
switch(a){case d.state.hide:return d.state.slideIN;case d.state.slideOut:return d.state.slideIN;case d.state.slideIN:return d.state.blink;case d.state.blink:return d.state.blink;case d.state.clear:return d.state.blink;default:return this.logger.error("current state: "+a+" has no next state"),d.state.hide}};b.prototype.show=function(a){var b=this.page.presenter.snackbar.version+1,c=this.nextState();this.logger.info("snackbar.show(); state:"+c+"; version:"+b);a.version=b;a.state=c;this.page.presenter.snackbar=
a;this.page.render();switch(c){case d.state.slideIN:setTimeout(this.slideOut,5E3,b);break;case d.state.blink:setTimeout(this.clear,500,b);break;default:this.logger.error("current state:"+d.state+" has no next state"),setTimeout(this.slideOut,5E3,b)}};b.prototype.clear=function(a){if(this.page.presenter.snackbar.version!==a)this.logger.info("snackbar.clear(); version:"+a+" - skipping");else{var b=this.page.presenter.snackbar.version+1;this.logger.info("snackbar.clear(); clear version:"+a+"; new version:"+
b);this.page.presenter.snackbar.version=b;this.page.presenter.snackbar.state=d.state.clear;this.page.render();setTimeout(this.slideOut,4E3,b)}};b.prototype.slideOut=function(a){this.page.presenter.snackbar.version!==a?this.logger.info("snackbar.slideOut(); version:"+a+" - skipping"):(this.logger.info("snackbar.slideOut(); version:"+a),a+=1,this.page.presenter.snackbar.version=a,this.page.presenter.snackbar.state=d.state.slideOut,this.page.render(),setTimeout(this.hide,600,a))};b.prototype.hide=function(a){this.page.presenter.snackbar.version!==
a?this.logger.info("snackbar.hide(); version:"+a+" - skipping"):(this.logger.info("snackbar.hide(); version:"+a),this.page.presenter.snackbar=new d.HiddenSnackbar(this.page.presenter.snackbar.version+1),this.page.render())};return b}();b.SnackbarHelper=g},function(g,b,e){var d=this&&this.__awaiter||function(a,b,c,d){return new (c||(c=Promise))(function(f,e){function g(a){try{n(d.next(a))}catch(w){e(w)}}function h(a){try{n(d["throw"](a))}catch(w){e(w)}}function n(a){a.done?f(a.value):(new c(function(b){b(a.value)})).then(g,
h)}n((d=d.apply(a,b||[])).next())})},c=this&&this.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(e)throw new TypeError("Generator is already executing.");for(;f;)try{if(e=1,g&&(k=g[c[0]&2?"return":c[0]?"throw":"next"])&&!(k=k.call(g,c[1])).done)return k;if(g=0,k)c=[0,k.value];switch(c[0]){case 0:case 1:k=c;break;case 4:return f.label++,{value:c[1],done:!1};case 5:f.label++;g=c[1];c=[0];continue;case 7:c=f.ops.pop();f.trys.pop();continue;default:if(!(k=
f.trys,k=0<k.length&&k[k.length-1])&&(6===c[0]||2===c[0])){f=0;continue}if(3===c[0]&&(!k||c[1]>k[0]&&c[1]<k[3]))f.label=c[1];else if(6===c[0]&&f.label<k[1])f.label=k[1],k=c;else if(k&&f.label<k[2])f.label=k[2],f.ops.push(c);else{k[2]&&f.ops.pop();f.trys.pop();continue}}c=b.call(a,f)}catch(w){c=[6,w],g=0}finally{e=k=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var f={label:0,sent:function(){if(k[0]&1)throw k[1];return k[1]},trys:[],ops:[]},e,g,k,n;return n={next:c(0),"throw":c(1),
"return":c(2)},"function"===typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n};Object.defineProperty(b,"__esModule",{value:!0});b.actionName="data-action";g=function(){function a(a){this.logger=a.logger;this.app=a.app;this.auth=a.domain.auth();this.auth.onAuthStatChanged(this.OnAuthStateChanged.bind(this));document.body.addEventListener("click",this)}a.prototype.handleEvent=function(a){try{var c=a.target;try{if("getAttribute"in c){var d=c.getAttribute(b.actionName);if(d)this[d+"On"+a.type](a)}}catch(f){this.logger.error("actions.handleEvent() failed; type="+
a.type+", element="+c+", error="+f.message)}}catch(f){this.logger.error("actions.handleEvent() failed; error="+f.message)}};a.prototype.closeSnackbarOnclick=function(a){this.app.hideSnackbar()};a.prototype.closePopupOnclick=function(a){this.app.hidePopup()};a.prototype.OnAuthStateChanged=function(a){this.app.onUserStateChanged(a)};a.prototype.signInWithGoogleOnclick=function(a){return d(this,void 0,void 0,function(){var b,d,f;return c(this,function(c){switch(c.label){case 0:return a.preventDefault(),
[4,this.auth.GooglePopup().signInWithPopup()];case 1:return b=c.sent(),d=b.currentUser,f=b.err,null===d&&(this.logger.error("signInWithGoogleOnclick failed; error="+f),this.app.showPopup({title:"Sign in failed",main:"We could not sign you in with Google Provider"})),[2]}})})};a.prototype.signOutOnclick=function(a){return d(this,void 0,void 0,function(){var b;return c(this,function(c){switch(c.label){case 0:return a.preventDefault(),[4,this.auth.GooglePopup().signOut()];case 1:return b=c.sent(),b||
(this.app.showPopup({title:"Sign out failed",main:"We could not sign you out"}),this.logger.error("signOutOnclick failed!")),[2]}})})};a.prototype.cleanup=function(){document.body.removeEventListener("click",this)};return a}();b.ActionHandler=g},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});var d=e(48),c=e(53),a=e(1);b.router=function(b){var e=d();e.get("/",function(a){var d=c.url.Query()("page_token");"pushstate"===a.type?b.rootVisit(d):b.rootBack(d)});e.get(a.path.articleRegExp,
function(a){var c=a.params.id;"pushstate"===a.type?b.articleVisit(c):b.articleBack(c)});e.get("/about",function(a){"pushstate"===a.type?b.aboutVisit():b.aboutBack()});e.get(a.path.profileReqExp,function(a){var c=a.params.id;"pushstate"===a.type?b.profileVisit(c):b.profileBack(c)});e.get("*",function(a){window.location.reload(!1)})}},function(g,b,e){(function(b){var c=function(){function a(a,b){"string"!==typeof a&&(a=a.toString(),a=a.slice(1,a.lastIndexOf("/")));return f(a,b)}function c(a,b){for(var c,
d={},f=1,e=a.length;f<e;f++)(c=a[f])&&(d[b[f-1].name]=c);return d}function d(){this.parentNode.removeChild(this)}function g(){this._params={};this._paths={};b.addEventListener("popstate",this,!1);b.addEventListener("pushstate",this,!1)}e(50);var f=e(51),t=g.prototype;t.get=function(b){var c=[],d=a(b,c);c=this._paths[d]||(this._paths[d]={keys:c,cb:[],re:d});d=1;for(var f=arguments.length;d<f;d++)c.cb.push(arguments[d]);return this};t.delete=function(b){var c=a(b,[]);c=this._paths[c];for(var d=1,f=
arguments.length;d<f;d++){var e=arguments[d];e=c?c.cb.lastIndexOf(e):-1;-1<e&&c.cb.splice(e,1)}return this};t.use=function(a,b){a=[].concat(a);for(var c=0,d=a.length;c<d;c++)this.get(a[c],b);return this};t.param=function(a,b){a=[].concat(a);for(var c=0,d=a.length;c<d;c++)this._params[a[c]]=b;return this};t.navigate=function(a,b){switch(!0){case !!b:switch(!0){case !!b.replace:case !!b.replaceState:history.replaceState(history.state,document.title,a)}break;case a===location.pathname+location.search:this.handleEvent({type:"samestate"});
break;default:var c=document;b=c.documentElement;c=c.createElement("a");c.href=a;c.onclick=d;b.insertBefore(c,b.firstChild);c.click()}return this};t.handleEvent=function(a){var b=this._paths,d;for(d in b)if(b.hasOwnProperty(d)){var f=b[d],e=f.re.exec(location.pathname);if(e){var g=[],h=[],l=this._params,m={params:c(e,f.keys),type:a.type},q=0,v=f.cb.length;for(d in m.params)l.hasOwnProperty(d)&&h.push(d);(function D(){h.length?(d=h.shift(),l[d](m,D,m.params[d])):function S(){if(q<v){var a=f.cb[q++];
0>g.lastIndexOf(a)?(g.push(a),a(m,S)):S()}}()})();break}}};return function(){return new g}}();g.exports=(b.hyperHTML||{}).app=c}).call(b,e(49))},function(g,b){b=function(){return this}();try{b=b||Function("return this")()||(0,eval)("this")}catch(e){"object"===typeof window&&(b=window)}g.exports=b},function(g,b){document.addEventListener("click",function(b){var d=b.target;var c=(d.closest||function(a){for(;d&&d.nodeName!==a;)d=d.parentNode;return d}).call(d,"A");if(c&&/^(?:_self)?$/i.test(c.target)&&
!c.hasAttribute("download")&&"external"!==c.getAttribute("rel")){var a=new URL(c.href);c=location;if(a.origin===c.origin){var e=a.pathname+a.search;a=a.hash;var g=!0;b.preventDefault();if(e===c.pathname+c.search)/^#[a-z][a-z0-9.:_-]+$/i.test(a)&&(d=document.querySelector(a+',[name="'+a.slice(1)+'"]'))&&(b.preventDefault=function(){g=!1},setTimeout(function(){g&&d.scrollIntoView(!0)})),history.replaceState(history.state,document.title,e+a);else{var h=new CustomEvent("pushstate");h.state=c.href;setTimeout(function(){dispatchEvent(h);
window.onpushstate&&onpushstate(h)});history.pushState(h.state,document.title,e+a)}}}},!0)},function(g,b,e){function d(a,b){var c=[],d=0,f=0,e="";b=b&&b.delimiter||"/";for(var g;null!=(g=k.exec(a));){var h=g[0],n=g[1],m=g.index;e+=a.slice(f,m);f=m+h.length;if(n)e+=n[1];else{var l=a[f];h=g[2];n=g[3];var p=g[4],t=g[5],x=g[6];m=g[7];e&&(c.push(e),e="");l=null!=h&&null!=l&&l!==h;var z="+"===x||"*"===x;x="?"===x||"*"===x;g=g[2]||b;p=p||t;c.push({name:n||d++,prefix:h||"",delimiter:g,optional:x,repeat:z,
partial:l,asterisk:!!m,pattern:p?p.replace(/([=!:$\/()])/g,"\\$1"):m?".*":"[^"+q(g)+"]+?"})}}f<a.length&&(e+=a.substr(f));e&&c.push(e);return c}function c(a){return encodeURI(a).replace(/[\/?#]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()})}function a(a){return encodeURI(a).replace(/[?#]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()})}function l(b){for(var d=Array(b.length),e=0;e<b.length;e++)"object"===typeof b[e]&&(d[e]=new RegExp("^(?:"+b[e].pattern+")$"));
return function(e,f){var g="";e=e||{};f=(f||{}).pretty?c:encodeURIComponent;for(var h=0;h<b.length;h++){var k=b[h];if("string"===typeof k)g+=k;else{var n=e[k.name];if(null==n)if(k.optional){k.partial&&(g+=k.prefix);continue}else throw new TypeError('Expected "'+k.name+'" to be defined');if(m(n)){if(!k.repeat)throw new TypeError('Expected "'+k.name+'" to not repeat, but received `'+JSON.stringify(n)+"`");if(0===n.length)if(k.optional)continue;else throw new TypeError('Expected "'+k.name+'" to not be empty');
for(var l=0;l<n.length;l++){var p=f(n[l]);if(!d[h].test(p))throw new TypeError('Expected all "'+k.name+'" to match "'+k.pattern+'", but received `'+JSON.stringify(p)+"`");g+=(0===l?k.prefix:k.delimiter)+p}}else{p=k.asterisk?a(n):f(n);if(!d[h].test(p))throw new TypeError('Expected "'+k.name+'" to match "'+k.pattern+'", but received "'+p+'"');g+=k.prefix+p}}}return g}}function q(a){return a.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function h(a,b){a.keys=b;return a}function f(a,b,c){m(b)||(c=b||
c,b=[]);c=c||{};for(var d=c.strict,e=!1!==c.end,f="",g=0;g<a.length;g++){var k=a[g];if("string"===typeof k)f+=q(k);else{var l=q(k.prefix),n="(?:"+k.pattern+")";b.push(k);k.repeat&&(n+="(?:"+l+n+")*");n=k.optional?k.partial?l+"("+n+")?":"(?:"+l+"("+n+"))?":l+"("+n+")";f+=n}}a=q(c.delimiter||"/");g=f.slice(-a.length)===a;d||(f=(g?f.slice(0,-a.length):f)+"(?:"+a+"(?=$))?");return h(new RegExp("^"+(e?f+"$":f+(d&&g?"":"(?="+a+"|$)")),c.sensitive?"":"i"),b)}function t(a,b,c){m(b)||(c=b||c,b=[]);c=c||{};
if(a instanceof RegExp){if(c=a.source.match(/\((?!\?)/g))for(var e=0;e<c.length;e++)b.push({name:e,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return h(a,b)}if(m(a)){e=[];for(var g=0;g<a.length;g++)e.push(t(a[g],b,c).source);a=new RegExp("(?:"+e.join("|")+")",c.sensitive?"":"i");return h(a,b)}return f(d(a,c),b,c)}var m=e(52);g.exports=t;g.exports.parse=d;g.exports.compile=function(a,b){return l(d(a,b))};g.exports.tokensToFunction=l;g.exports.tokensToRegExp=
f;var k=/(\\.)|([\/.])?(?:(?:\:(\w+)(?:\(((?:\\.|[^\\()])+)\))?|\(((?:\\.|[^\\()])+)\))([+*?])?|(\*))/g},function(g,b){g.exports=Array.isArray||function(b){return"[object Array]"==Object.prototype.toString.call(b)}},function(g,b,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){}b.Query=function(a){var b=new d,c=function(a){try{return b[a]||""}catch(k){return""}};try{a||(a=window.location.search.substring(1));var e=decodeURIComponent(a);if(!e||""===e)return c;a=0;for(var f=
e.split("&");a<f.length;a++){var g=f[a].split("=");2===g.length&&(b[g[0]]=g[1])}return c}catch(m){return c}};return b}();b.url=g;var d=function(){return function(){}}()}])}]);
